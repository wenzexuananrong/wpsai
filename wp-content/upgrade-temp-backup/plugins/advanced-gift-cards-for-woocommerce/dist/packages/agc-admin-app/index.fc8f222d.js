import{c as we}from"../../common/reactLib.28e086c5.js";function Ea(){import.meta.url,import("_").catch(()=>1);async function*a(){}}const{antd:{Popover:ge},antdIcons:{ExclamationCircleOutlined:Ae}}=acfwpElements,_e=a=>{const{content:e}=a;return acfwpElements.element.createElement("span",{className:"tooltip"},acfwpElements.element.createElement(ge,{overlayClassName:"dashboard-tooltip",placement:"top",content:acfwpElements.element.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),trigger:"click"},acfwpElements.element.createElement(Ae,null)))},{antd:{Card:be}}=acfwpElements,De=a=>{const{widget:e}=a;return acfwpElements.element.createElement(be,{className:"widget big-number-widget"},acfwpElements.element.createElement("p",{className:"title"},acfwpElements.element.createElement("span",{className:"widget-value",dangerouslySetInnerHTML:{__html:e.title_html}}),e!=null&&e.tooltip_html?acfwpElements.element.createElement(_e,{content:e.tooltip_html}):null),acfwpElements.element.createElement("p",{className:"description"},acfwpElements.element.createElement("span",{className:"widget-name",dangerouslySetInnerHTML:{__html:e.description_html}})))},{element:{Fragment:Te},antd:{Table:Ce}}=acfwpElements,ve=a=>{const{widget:e}=a,{admin_url:r}=acfwAdminApp,{main_page:{labels:c}}=agcfwAdminApp,i=[{title:c.product,dataIndex:"product",key:"product",render:(s,l)=>acfwpElements.element.createElement("a",{href:"".concat(r,"post.php?post=").concat(l.id,"&action=edit"),target:"_blank",rel:"noreferrer"},s)},{title:c.quantity,dataIndex:"quantity",key:"quantity"},{title:acfwpElements.element.createElement(Te,null,acfwpElements.element.createElement("span",{className:"value-label"},c.value),e!=null&&e.tooltip_html?acfwpElements.element.createElement(_e,{content:e.tooltip_html}):null),dataIndex:"value",key:"value"}];return acfwpElements.element.createElement("div",{className:"widget gift-card-table-widget"},acfwpElements.element.createElement("div",{className:"widget-header"},acfwpElements.element.createElement("h3",{className:"widget-name",dangerouslySetInnerHTML:{__html:e.title_html}})),e.table_data&&acfwpElements.element.createElement(Ce,{bordered:!0,dataSource:e.table_data,columns:i,pagination:!1}))},ne=a=>{const{widgets:e}=a;return e?acfwpElements.element.createElement("div",{className:"agc-report-widgets"},e.map((r,c)=>{switch(r.type){case"big_number":return acfwpElements.element.createElement(De,{key:r.key,widget:r});case"table":return acfwpElements.element.createElement(ve,{key:r.key,widget:r});case"section_title":return acfwpElements.element.createElement("h2",{key:r.key,className:"section-title"},r.title_html)}return null})):null},{antd:{Card:Se,Skeleton:Ie}}=acfwpElements,re=a=>{const{count:e}=a;return acfwpElements.element.createElement("div",{className:"agc-report-widgets"},[...Array(e)].map((r,c)=>acfwpElements.element.createElement(Se,{key:c,className:"widget widget-skeleton"},acfwpElements.element.createElement(Ie,{active:!0}))))},{antd:{Select:se,DatePicker:Re},moment:ya}=acfwpElements,Be=a=>{const{store_credits_page:{labels:e,period_options:r}}=acfwAdminApp,{className:c,periodValue:i,startPeriod:s,endPeriod:l,onPeriodChange:u,onCustomDateRange:o}=a;return acfwpElements.element.createElement("div",{className:"report-date-range-picker ".concat(c)},acfwpElements.element.createElement(se,{value:i,onSelect:u},r.map((d,E)=>acfwpElements.element.createElement(se.Option,{key:E,value:d.value},d.label))),acfwpElements.element.createElement(Re.RangePicker,{value:[s,l],onChange:o}))};var W=(a=>(a.READ_DASHBOARD_MAIN_WIDGETS_DATA="READ_DASHBOARD_MAIN_WIDGETS_DATA",a.READ_DASHBOARD_ACTIVITY_WIDGETS_DATA="READ_DASHBOARD_ACTIVITY_WIDGETS_DATA",a.SET_DASHBOARD_MAIN_WIDGETS_DATA="SET_DASHBOARD_MAIN_WIDGETS_DATA",a.SET_DASHBOARD_ACTIVITY_WIDGETS_DATA="SET_DASHBOARD_ACTIVITY_WIDGETS_DATA",a))(W||{});const ae={readMainWidgetsData:a=>({type:"READ_DASHBOARD_MAIN_WIDGETS_DATA",payload:a}),readActivityWidgetsData:a=>({type:"READ_DASHBOARD_ACTIVITY_WIDGETS_DATA",payload:a}),setMainWidgetsData:a=>({type:"SET_DASHBOARD_MAIN_WIDGETS_DATA",payload:a}),setActivityWidgetsData:a=>({type:"SET_DASHBOARD_ACTIVITY_WIDGETS_DATA",payload:a})},{moment:y}=acfwpElements,Ge=a=>{let e=y().startOf("month"),r=y().startOf("day");switch(a){case"week_to_date":e=y().startOf("week"),r=y().startOf("day");break;case"month_to_date":e=y().startOf("month"),r=y().startOf("day");break;case"quarter_to_date":e=y().startOf("quarter"),r=y().startOf("day");break;case"year_to_date":e=y().startOf("year"),r=y().startOf("day");break;case"last_week":e=y().subtract(1,"weeks").startOf("week"),r=y().subtract(1,"weeks").endOf("week");break;case"last_month":e=y().subtract(1,"months").startOf("month"),r=y().subtract(1,"months").endOf("month");break;case"last_quarter":e=y().subtract(1,"quarters").startOf("quarter"),r=y().subtract(1,"quarters").endOf("quarter");break;case"last_year":e=y().subtract(1,"years").startOf("year"),r=y().subtract(1,"years").endOf("year");break}return[e,r]};function xe(a){const{currency:e}=acfwAdminApp.store_credits_page,r="^\\d+(\\".concat(e.decimal_separator,"\\d{1,").concat(e.decimals,"})?$");return new RegExp(r).test(a)}const{element:{Fragment:ha,useEffect:le,useState:M},redux:{bindActionCreators:Oe,connect:ke},antd:{Row:wa,Col:ga,Card:Aa},moment:ce}=acfwpElements,{readMainWidgetsData:Ne,readActivityWidgetsData:Pe}=ae,$e=a=>{const{mainWidgets:e,activityWidgets:r,actions:c}=a,[i,s]=M("month_to_date"),[l,u]=M(ce().startOf("month")),[o,d]=M(ce().startOf("day")),[E,T]=M(!1),[C,h]=M(!1);le(()=>{e!=null&&e.length||(T(!0),c.readMainWidgetsData({successCB:()=>T(!1)}))},[]),le(()=>{h(!0),c.readActivityWidgetsData({startPeriod:l.format("YYYY-MM-DD"),endPeriod:o.format("YYYY-MM-DD"),successCB:()=>h(!1)})},[l,o]);const w=f=>{if(f===i)return;const[g,S]=Ge(f);s(f),u(g),d(S)},_=f=>{var g,S;f&&(u((g=f[0])!=null?g:""),d((S=f[1])!=null?S:""),s("custom"))};return acfwpElements.element.createElement("div",{className:"agc-dashboard"},E?acfwpElements.element.createElement(re,{count:4}):acfwpElements.element.createElement(ne,{widgets:e}),acfwpElements.element.createElement("div",{className:"activity-report"},acfwpElements.element.createElement(Be,{periodValue:i,startPeriod:l,endPeriod:o,onPeriodChange:w,onCustomDateRange:_}),acfwpElements.element.createElement("h2",{className:"section-title"},"Gift Card Activity"),C?acfwpElements.element.createElement(re,{count:8}):acfwpElements.element.createElement(ne,{widgets:r})))},Fe=a=>({mainWidgets:a.mainWidgets,activityWidgets:a.activityWidgets}),Me=a=>({actions:Oe({readMainWidgetsData:Ne,readActivityWidgetsData:Pe},a)}),Le=ke(Fe,Me)($e),{element:{useEffect:He,useState:We},antd:{Alert:Ue,Form:I,Divider:ie,Input:L,Select:Ye,DatePicker:oe,Button:K,Radio:X},moment:j}=acfwpElements,je=a=>{var h;const{editData:e,handleCreateGiftCard:r,handleEditGiftCard:c}=a,{adminUrl:i,main_page:{labels:s,status_options:l}}=agcfwAdminApp,u=Object.entries(l).map(([w,_])=>({label:_,value:w})),o="YYYY-MM-DD HH:mm:ss",[d]=I.useForm(),[E,T]=We((h=e.send_to)!=null?h:""),C=w=>{const{date_created:_,date_expire:f,send_to:g,recipient_name:S,recipient_email:v,short_message:N,...P}=w,b={...P,id:e.id,date_created:_?j(_).format(o):"",date_expire:f?j(f).format(o):"",recipient:{send_to:g,name:S,email:v,short_message:N}};b.id?c(b):r(b)};return He(()=>{var w;return T((w=e.send_to)!=null?w:"")},[e]),acfwpElements.element.createElement(I,{className:"edit-gift-card-form",form:d,labelCol:{span:6},wrapperCol:{span:18},initialValues:{...e,date_created:e.date_created?j(e.date_created):"",date_expire:e.date_expire?j(e.date_expire):""},onFinish:C},acfwpElements.element.createElement(I.Item,{label:s.gift_card_code,name:"code",rules:[{required:!0,message:s.invalid_field_message.replace("{field}",s.gift_card_code)}]},acfwpElements.element.createElement(L,null)),!!e.id&&!!e.order_id&&acfwpElements.element.createElement(I.Item,{className:"order-item-product",label:s.product},acfwpElements.element.createElement("span",null,e.product_name),acfwpElements.element.createElement(K,{className:"view-order-btn",href:"".concat(i,"post.php?post=").concat(e.order_id,"&action=edit"),target:"_blank"},s.view_order)),acfwpElements.element.createElement(I.Item,{label:s.status,name:"status",rules:[{required:!0,message:s.invalid_field_message.replace("{field}",s.status)}]},acfwpElements.element.createElement(Ye,{options:u})),acfwpElements.element.createElement(I.Item,{label:s.value,name:"value",rules:[{required:!0,message:s.invalid_field_message.replace("{field}",s.status)},{validator:(w,_)=>xe(_)?Promise.resolve():Promise.reject(new Error(s.invalid_price))}]},acfwpElements.element.createElement(L,{className:"wc_input_price"})),acfwpElements.element.createElement(I.Item,{label:s.date_created,name:"date_created",rules:[{required:!0,message:s.invalid_field_message.replace("{field}",s.date_created)}]},acfwpElements.element.createElement(oe,{format:o,showTime:!0})),acfwpElements.element.createElement(I.Item,{label:s.date_expire,name:"date_expire"},acfwpElements.element.createElement(oe,{format:o,showTime:!0})),acfwpElements.element.createElement(ie,null),acfwpElements.element.createElement(I.Item,{label:s.send_to,name:"send_to"},acfwpElements.element.createElement(X.Group,{onChange:w=>T(w.target.value)},acfwpElements.element.createElement(X,{value:"friend"},s.friend),acfwpElements.element.createElement(X,{value:"me"},s.me))),acfwpElements.element.createElement(I.Item,{label:s.recipient_name,name:"recipient_name",rules:[{required:E==="friend",message:s.invalid_field_message.replace("{field}",s.recipient_name)}]},acfwpElements.element.createElement(L,{disabled:E!=="friend"})),acfwpElements.element.createElement(I.Item,{label:s.recipient_email,name:"recipient_email",rules:[{required:E==="friend",message:s.invalid_field_message.replace("{field}",s.recipient_email)},{type:"email",message:s.invalid_email}]},acfwpElements.element.createElement(L,{disabled:E!=="friend"})),acfwpElements.element.createElement(I.Item,{label:s.short_message,name:"short_message"},acfwpElements.element.createElement(L.TextArea,{rows:3,disabled:E!=="friend"})),acfwpElements.element.createElement(ie,null),acfwpElements.element.createElement(I.Item,{className:"form-actions-wrap",label:" "},acfwpElements.element.createElement(K,{onClick:()=>d.resetFields()},s.reset),acfwpElements.element.createElement(K,{type:"primary",htmlType:"submit"},e.id?s.save_changes:s.create_gift_card)),!e.id&&acfwpElements.element.createElement(Ue,{message:s.manual_gift_card_info,type:"info",showIcon:!0}))},{element:{Fragment:ba,useEffect:Da,useState:Ta},redux:{bindActionCreators:Ca,connect:va},antd:{Button:Q,Popconfirm:me},antdIcons:{EditOutlined:qe,MailOutlined:Ve,DeleteOutlined:ze},moment:Sa}=acfwpElements,Ke=a=>{var u;const{giftCard:e,editDispatch:r,handleDeleteGiftCard:c,handleSendEmail:i}=a,{main_page:{labels:s}}=agcfwAdminApp,l=()=>{const{value_raw:o}=e;r({type:"all",payload:{...e,value:o,product_name:e!=null&&e.product?e.product.name:"",order_id:e!=null&&e.product?e.product.order_id:0,send_to:e!=null&&e.recipient?e.recipient.send_to:"",recipient_name:e!=null&&e.recipient?e.recipient.name:"",recipient_email:e!=null&&e.recipient?e.recipient.email:"",short_message:e!=null&&e.recipient?e.recipient.short_message:"",open:!0}})};return acfwpElements.element.createElement("div",{className:"gift-card-actions"},acfwpElements.element.createElement(Q,{className:"edit-gift-card",size:"small",onClick:()=>l()},acfwpElements.element.createElement(qe,null)),acfwpElements.element.createElement(me,{title:"Resend gift card email to ".concat((u=e==null?void 0:e.recipient)==null?void 0:u.email,"?"),onConfirm:()=>i(e.id)},acfwpElements.element.createElement(Q,{className:"send-gift-card",size:"small",disabled:!(e!=null&&e.recipient&&e.recipient.email)},acfwpElements.element.createElement(Ve,null))),acfwpElements.element.createElement(me,{title:s.confirm_delete_gift_card,okText:s.yes,okType:"danger",cancelText:s.danger,onConfirm:()=>c(e.id)},acfwpElements.element.createElement(Q,{className:"delete-gift-card",size:"small"},acfwpElements.element.createElement(ze,null))))},{antd:{Tag:Xe}}=acfwpElements,Qe=a=>{var s,l;const{status:e}=a,{main_page:{labels:r,status_options:c}}=agcfwAdminApp,i={pending:"#e6b41e",used:"#1ed14b",invalid:"#b32d2e",expired:"#2c3338"};return acfwpElements.element.createElement(Xe,{color:(s=i[e])!=null?s:""},(l=c[e])!=null?l:"")},{moment:Je}=acfwpElements,ee={open:!1,key:"",id:0,code:"",status:"pending",value:0,date_created:"",date_expire:"",product_name:"",order_id:0,send_to:"friend",recipient_name:"",recipient_email:"",short_message:""},Ze=(a,e)=>{switch(e.type){case"all":return{...e.payload,open:!0};case"open":return{...ee,date_created:Je().format("YYYY-MM-DD HH:mm:ss"),open:e.payload};case"reset":return ee;case"code":return{...a,code:e.payload};case"status":return{...a,status:e.payload};case"value":return{...a,value:e.payload};case"date_created":return{...a,date_created:e.payload};case"date_expire":return{...a,date_expire:e.payload};case"send_to":return{...a,send_to:e.payload}}return a};var te=(a=>(a.READ_GIFT_CARD="READ_GIFT_CARD",a.CREATE_GIFT_CARD="CREATE_GIFT_CARD",a.UPDATE_GIFT_CARD="UPDATE_GIFT_CARD",a.DELETE_GIFT_CARD="DELETE_GIFT_CARD",a.REHYDRATE_STORE_GIFT_CARDS="REHYDRATE_STORE_GIFT_CARDS",a.SET_STORE_GIFT_CARDS="SET_STORE_GIFT_CARDS",a.SET_SINGLE_GIFT_CARD="SET_SINGLE_GIFT_CARD",a.SEND_GIFT_CARD_EMAIL="SEND_GIFT_CARD_EMAIL",a))(te||{});const U={readGiftCard:a=>({type:"READ_GIFT_CARD",payload:a}),createGiftCard:a=>({type:"CREATE_GIFT_CARD",payload:a}),updateGiftCard:a=>({type:"UPDATE_GIFT_CARD",payload:a}),deleteGiftCard:a=>({type:"DELETE_GIFT_CARD",payload:a}),rehydrateStoreGiftCards:a=>({type:"REHYDRATE_STORE_GIFT_CARDS",payload:a}),sendGiftCardEmail:a=>({type:"SEND_GIFT_CARD_EMAIL",payload:a}),setStoreGiftCards:a=>({type:"SET_STORE_GIFT_CARDS",payload:a}),setSingleGiftCard:a=>({type:"SET_SINGLE_GIFT_CARD",payload:a})};const{element:{Fragment:et,useEffect:tt,useState:G,useReducer:at},redux:{bindActionCreators:nt,connect:rt},antd:{Card:st,Table:lt,message:B,Input:ct,Select:it,Button:de,Pagination:ot,Divider:mt,Modal:dt},antdIcons:{PlusOutlined:ft},moment:Ia}=acfwpElements,{rehydrateStoreGiftCards:pt,createGiftCard:ut,updateGiftCard:Et,deleteGiftCard:_t,sendGiftCardEmail:yt}=U,ht=a=>{const{giftCards:e,actions:r}=a,{main_page:{labels:c,status_options:i}}=agcfwAdminApp,[s,l]=G(-1),[u,o]=G(!1),[d,E]=G(!0),[T,C]=at(Ze,ee),[h,w]=G(""),[_,f]=G(null),[g,S]=G(1),v=Object.entries(i).map(([t,n])=>({label:n,value:t})),N=t=>{o(!0),r.createGiftCard({data:{...t,date_format:"Y-m-d H:i:s",order_item_id:0},successCB:n=>{B.success(n.data.message)},failCB:({error:n})=>{B.error(n.response.data.message)},alwaysCB:()=>{C({type:"reset"}),o(!1)}})},P=t=>{o(!0),r.updateGiftCard({data:{...t,id:T.id,date_format:"Y-m-d H:i:s"},successCB:n=>{B.success(n.data.message)},failCB:({error:n})=>{B.error(n.response.data.message)},alwaysCB:()=>{C({type:"reset"}),o(!1)}})},b=t=>{o(!0),r.deleteGiftCard({id:t,successCB:n=>{B.success(n.data.message)},failCB:({error:n})=>{B.error(n.response.data.message)},alwaysCB:()=>{E(!0)}})},V=t=>{r.sendGiftCardEmail({id:t,successCB:n=>{B.success(n.data.message)},failCB:({error:n})=>{B.error(n.response.data.message)}})},$=[{title:c.gift_card_code,dataIndex:"code",key:"code",className:"gift-card-code"},{title:c.status,dataIndex:"status",key:"status",className:"gift-card-status",render:t=>acfwpElements.element.createElement(Qe,{status:t})},{title:c.product,dataIndex:"product",key:"product",className:"gift-card-product",render:(t,n)=>n!=null&&n.product?n.product.name:""},{title:c.amount,dataIndex:"value",key:"value",className:"gift-card-amount"},{title:c.date_created,dataIndex:"date_created",key:"date_created",className:"gift-card-date-created"},{title:c.date_expire,dataIndex:"date_expire",key:"date_expire",className:"gift-card-date-expires"},{title:"",dataIndex:"id",key:"actions",className:"gift-card-actions",render:(t,n)=>acfwpElements.element.createElement(Ke,{giftCard:n,editDispatch:C,handleDeleteGiftCard:b,handleSendEmail:V})}];return tt(()=>{d&&(o(!0),r.rehydrateStoreGiftCards({query:{search:h,page:g,status:_!=null?_:""},successCB:t=>l(t.headers["x-total"]),alwaysCB:()=>{o(!1),E(!1)}}))},[d]),acfwpElements.element.createElement(st,{className:"manage-gift-cards",title:acfwpElements.element.createElement(et,null,acfwpElements.element.createElement("span",null,c.gift_cards),acfwpElements.element.createElement(mt,{type:"vertical"}),acfwpElements.element.createElement(de,{onClick:()=>C({type:"open",payload:!0}),icon:acfwpElements.element.createElement(ft,null)},c.add_new_gift_card))},acfwpElements.element.createElement("div",{className:"gc-filter-form"},acfwpElements.element.createElement(ct,{placeholder:c.search,value:h,onChange:t=>w(t.target.value),allowClear:!0}),acfwpElements.element.createElement(it,{placeholder:c.select_status,options:v,value:_,allowClear:!0,onSelect:t=>f(t),onClear:()=>f(null)}),acfwpElements.element.createElement(de,{onClick:()=>E(!0)},c.search)),acfwpElements.element.createElement(lt,{className:"gift-cards-table",loading:u,columns:$,dataSource:e,pagination:!1}),s>-1&&acfwpElements.element.createElement(ot,{defaultCurrent:g,hideOnSinglePage:!0,current:g,total:s,pageSize:10,showSizeChanger:!1,onChange:t=>{S(t),E(!0)}}),acfwpElements.element.createElement(dt,{className:"edit-gift-card-modal",open:T.open,okText:"Save Changes",footer:null,destroyOnClose:!0,onCancel:()=>{C({type:"reset"})}},acfwpElements.element.createElement(je,{editData:T,editDispatch:C,handleEditGiftCard:P,handleCreateGiftCard:N})))},wt=a=>({giftCards:a.giftCards}),gt=a=>({actions:nt({rehydrateStoreGiftCards:pt,createGiftCard:ut,updateGiftCard:Et,deleteGiftCard:_t,sendGiftCardEmail:yt},a)}),At=rt(wt,gt)(ht),bt=a=>{const{slug:e}=a;return e==="dashboard"?acfwpElements.element.createElement(Le,null):e==="manage-gift-cards"?acfwpElements.element.createElement(At,null):null},{router:{useHistory:Dt,useLocation:Tt},antd:{Tabs:fe},pathPrefix:Ct}=acfwpElements,vt=()=>{const{logo:a}=acfwAdminApp,{main_page:{title:e,tabs:r}}=agcfwAdminApp,i=new URLSearchParams(Tt().search).get("tab"),s=i?r.findIndex(o=>o.slug===i):0,l=Dt(),u=o=>{l.push("".concat(Ct,"admin.php?page=acfw-advanced-gift-cards&tab=").concat(r[o].slug))};return acfwpElements.element.createElement("div",{className:"agcfw-admin-app acfw-admin-app"},acfwpElements.element.createElement("div",{className:"page-header agc-page-header"},acfwpElements.element.createElement("img",{className:"acfw-logo",src:a,alt:"acfw logo"}),acfwpElements.element.createElement("h1",null,e)),acfwpElements.element.createElement(fe,{activeKey:s.toString(),defaultActiveKey:s.toString(),onTabClick:u},r.map((o,d)=>acfwpElements.element.createElement(fe.TabPane,{tab:o.label,key:d.toString()},acfwpElements.element.createElement(bt,{slug:o.slug})))))},St=()=>jQuery.ajax({url:ajaxurl,data:{action:"agcfw_get_license_details"},dataType:"json"}),It=a=>{const{license_page:{_formNonce:e}}=agcfwAdminApp;return jQuery.ajax({method:"post",url:ajaxurl,data:{action:"agcfw_activate_license","activation-email":a.email,"license-key":a.key,"ajax-nonce":e},dataType:"json"})};const{element:{useEffect:Rt,useState:J,Fragment:Bt},antd:{Form:H,Input:pe,Button:Gt,Typography:xt,Skeleton:Ot,message:ue},antdIcons:{CheckCircleFilled:kt}}=acfwpElements,Nt=()=>{const[a,e]=J({key:!1}),[r,c]=J(!1),[i,s]=J(!1),{Link:l}=xt,[u]=H.useForm(),{license_page:{title:o,about_content:d,license_status:E,indicator:T,specs:C,formlabels:h,spinner_img:w}}=agcfwAdminApp;Rt(()=>{St().done(f=>{f.status==="success"&&e({key:f.license_key?f.license_key:"",email:f.email?f.email:"",is_active:f.is_active})}).always(()=>c(!0))},[e,c]);const _=f=>{s(!0),It(f).done(g=>{var S,v;g.status==="success"?(ue.success(g.success_msg),e({key:(S=f.key)!=null?S:"",email:(v=f.email)!=null?v:"",is_active:"yes"})):(["inactive","expired"].includes(g.license_status)&&e({...a,is_active:"no"}),ue.error(g.error_msg))}).always(()=>s(!1))};return acfwpElements.element.createElement("div",{className:"acfw-license-box"},acfwpElements.element.createElement("div",{className:"overview"},acfwpElements.element.createElement("h1",null,o)),acfwpElements.element.createElement("div",{className:"license-info ".concat(i?"show":"")},acfwpElements.element.createElement("div",{className:"heading"},acfwpElements.element.createElement("div",{className:"left"},acfwpElements.element.createElement("span",null,E)),acfwpElements.element.createElement("div",{className:"right"},acfwpElements.element.createElement("span",{className:"action-button active-indicator no-hover ".concat(a.is_active=="yes"?"activated":"")},a.is_active=="yes"&&acfwpElements.element.createElement(kt,null),a.is_active=="yes"?T.active:T.inactive))),acfwpElements.element.createElement("div",{className:"content"},acfwpElements.element.createElement("p",null,d),acfwpElements.element.createElement("table",{className:"license-specs"},acfwpElements.element.createElement("thead",null,acfwpElements.element.createElement("tr",null,C.map(f=>acfwpElements.element.createElement("th",{key:f.label},f.label)))),acfwpElements.element.createElement("tbody",null,acfwpElements.element.createElement("tr",null,C.map(f=>acfwpElements.element.createElement("td",{key:f.value},f.value)))))),acfwpElements.element.createElement("div",{className:"license-form"},r?acfwpElements.element.createElement(Bt,null,acfwpElements.element.createElement(H,{layout:"vertical",form:u,initialValues:a,onFinish:_},acfwpElements.element.createElement(H.Item,{className:"license-form-item",label:h.license_key,name:"key"},acfwpElements.element.createElement(pe,{type:"password",autocomplete:"off"})),acfwpElements.element.createElement(H.Item,{className:"license-form-item",label:h.email,name:"email"},acfwpElements.element.createElement(pe,{type:"email",autocomplete:"off"})),acfwpElements.element.createElement(H.Item,{className:"license-form-item form-action ".concat(a.is_active=="yes"?"grayed":"")},acfwpElements.element.createElement(Gt,{type:"primary",htmlType:"submit"},h.button))),acfwpElements.element.createElement("div",{className:"help-row"},h.help.text," ",acfwpElements.element.createElement(l,{href:h.help.link,target:"_blank"},h.help.login))):acfwpElements.element.createElement(Ot,{loading:!0,active:!0,paragraph:{rows:1}})),acfwpElements.element.createElement("div",{className:"overlay"},acfwpElements.element.createElement("img",{src:w,alt:"spinner"}))))},{element:{useState:Pt,useEffect:$t},appStore:{store:Z}}=acfwpElements,Ft=()=>{const[a,e]=Pt("");$t(()=>{a||e(Z.getState().page)},[]);const r=()=>{const c=Z.getState().page;a!==c&&e(c)};return Z.subscribe(r),a==="acfw-advanced-gift-cards"?acfwpElements.element.createElement(vt,null):a==="acfw-license/AGC"?acfwpElements.element.createElement(Nt,null):null};const Mt=(a=null,e)=>{switch(e.type){case W.SET_DASHBOARD_MAIN_WIDGETS_DATA:{const{widgets:r}=e.payload;return r}default:return a}},Lt=(a=null,e)=>{switch(e.type){case W.SET_DASHBOARD_ACTIVITY_WIDGETS_DATA:{const{widgets:r}=e.payload;return r}default:return a}},Ht=(a=[],e)=>{switch(e.type){case te.SET_STORE_GIFT_CARDS:{const{giftCards:r}=e.payload;return r}case te.SET_SINGLE_GIFT_CARD:{const{giftCard:r}=e.payload,c=[...a],i=c.findIndex(s=>s.id===r.id);return i>-1?c[i]=r:c.unshift(r),c}default:return a}};(function(){(function(a){(function(e){var r={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function c(t){return t&&DataView.prototype.isPrototypeOf(t)}if(r.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(t){return t&&i.indexOf(Object.prototype.toString.call(t))>-1};function l(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function u(t){return typeof t!="string"&&(t=String(t)),t}function o(t){var n={next:function(){var m=t.shift();return{done:m===void 0,value:m}}};return r.iterable&&(n[Symbol.iterator]=function(){return n}),n}function d(t){this.map={},t instanceof d?t.forEach(function(n,m){this.append(m,n)},this):Array.isArray(t)?t.forEach(function(n){this.append(n[0],n[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(n){this.append(n,t[n])},this)}d.prototype.append=function(t,n){t=l(t),n=u(n);var m=this.map[t];this.map[t]=m?m+", "+n:n},d.prototype.delete=function(t){delete this.map[l(t)]},d.prototype.get=function(t){return t=l(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(l(t))},d.prototype.set=function(t,n){this.map[l(t)]=u(n)},d.prototype.forEach=function(t,n){for(var m in this.map)this.map.hasOwnProperty(m)&&t.call(n,this.map[m],m,this)},d.prototype.keys=function(){var t=[];return this.forEach(function(n,m){t.push(m)}),o(t)},d.prototype.values=function(){var t=[];return this.forEach(function(n){t.push(n)}),o(t)},d.prototype.entries=function(){var t=[];return this.forEach(function(n,m){t.push([m,n])}),o(t)},r.iterable&&(d.prototype[Symbol.iterator]=d.prototype.entries);function E(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function T(t){return new Promise(function(n,m){t.onload=function(){n(t.result)},t.onerror=function(){m(t.error)}})}function C(t){var n=new FileReader,m=T(n);return n.readAsArrayBuffer(t),m}function h(t){var n=new FileReader,m=T(n);return n.readAsText(t),m}function w(t){for(var n=new Uint8Array(t),m=new Array(n.length),D=0;D<n.length;D++)m[D]=String.fromCharCode(n[D]);return m.join("")}function _(t){if(t.slice)return t.slice(0);var n=new Uint8Array(t.byteLength);return n.set(new Uint8Array(t)),n.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:r.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:r.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():r.arrayBuffer&&r.blob&&c(t)?(this._bodyArrayBuffer=_(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))?this._bodyArrayBuffer=_(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var t=E(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?E(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(C)}),this.text=function(){var t=E(this);if(t)return t;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(w(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(N)}),this.json=function(){return this.text().then(JSON.parse)},this}var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function S(t){var n=t.toUpperCase();return g.indexOf(n)>-1?n:t}function v(t,n){n=n||{};var m=n.body;if(t instanceof v){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!m&&t._bodyInit!=null&&(m=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new d(n.headers)),this.method=S(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&m)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(m)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})};function N(t){var n=new FormData;return t.trim().split("&").forEach(function(m){if(m){var D=m.split("="),A=D.shift().replace(/\+/g," "),p=D.join("=").replace(/\+/g," ");n.append(decodeURIComponent(A),decodeURIComponent(p))}}),n}function P(t){var n=new d,m=t.replace(/\r?\n[\t ]+/g," ");return m.split(/\r?\n/).forEach(function(D){var A=D.split(":"),p=A.shift().trim();if(p){var Y=A.join(":").trim();n.append(p,Y)}}),n}f.call(v.prototype);function b(t,n){n||(n={}),this.type="default",this.status=n.status===void 0?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new d(n.headers),this.url=n.url||"",this._initBody(t)}f.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var V=[301,302,303,307,308];b.redirect=function(t,n){if(V.indexOf(n)===-1)throw new RangeError("Invalid status code");return new b(null,{status:n,headers:{location:t}})},e.DOMException=a.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(n,m){this.message=n,this.name=m;var D=Error(n);this.stack=D.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function $(t,n){return new Promise(function(m,D){var A=new v(t,n);if(A.signal&&A.signal.aborted)return D(new e.DOMException("Aborted","AbortError"));var p=new XMLHttpRequest;function Y(){p.abort()}p.onload=function(){var F={status:p.status,statusText:p.statusText,headers:P(p.getAllResponseHeaders()||"")};F.url="responseURL"in p?p.responseURL:F.headers.get("X-Request-URL");var z="response"in p?p.response:p.responseText;m(new b(z,F))},p.onerror=function(){D(new TypeError("Network request failed"))},p.ontimeout=function(){D(new TypeError("Network request failed"))},p.onabort=function(){D(new e.DOMException("Aborted","AbortError"))},p.open(A.method,A.url,!0),A.credentials==="include"?p.withCredentials=!0:A.credentials==="omit"&&(p.withCredentials=!1),"responseType"in p&&r.blob&&(p.responseType="blob"),A.headers.forEach(function(F,z){p.setRequestHeader(z,F)}),A.signal&&(A.signal.addEventListener("abort",Y),p.onreadystatechange=function(){p.readyState===4&&A.signal.removeEventListener("abort",Y)}),p.send(typeof A._bodyInit>"u"?null:A._bodyInit)})}return $.polyfill=!0,a.fetch||(a.fetch=$,a.Headers=d,a.Request=v,a.Response=b),e.Headers=d,e.Request=v,e.Response=b,e.fetch=$,Object.defineProperty(e,"__esModule",{value:!0}),e})({})})(typeof self<"u"?self:we)})();const{axiosInstance:ye,redux:{sagaEffects:Wt}}=acfwpElements,{put:q,call:he,takeEvery:Ee}=Wt;function*Ut(a){const{processingCB:e,successCB:r,failCB:c}=a.payload;try{typeof e=="function"&&e();const i=yield he(ye.get,"coupons/v1/reports/gift-cards");i&&i.data&&q&&(yield q(ae.setMainWidgetsData({widgets:i.data}))),typeof r=="function"&&r(i)}catch(i){typeof c=="function"&&c({error:i})}}function*Yt(a){const{startPeriod:e,endPeriod:r,processingCB:c,successCB:i,failCB:s}=a.payload;try{typeof c=="function"&&c();const l=yield he(ye.get,"coupons/v1/reports/gift-cards/activity",{params:{startPeriod:e,endPeriod:r}});l&&l.data&&q&&(yield q(ae.setActivityWidgetsData({widgets:l.data}))),typeof i=="function"&&i(l)}catch(l){typeof s=="function"&&s({error:l})}}const jt=[Ee(W.READ_DASHBOARD_MAIN_WIDGETS_DATA,Ut),Ee(W.READ_DASHBOARD_ACTIVITY_WIDGETS_DATA,Yt)],{axiosInstance:O,redux:{sagaEffects:qt}}=acfwpElements,{put:R,call:k,takeEvery:x}=qt;function*Vt(a){const{id:e,processingCB:r,successCB:c,failCB:i,alwaysCB:s}=a.payload;try{typeof r=="function"&&r();const l=yield k(O.get,"coupons/v1/gift-cards/".concat(e));l&&l.data&&R&&(yield R(U.setSingleGiftCard({giftCard:l.data})),typeof c=="function"&&c(l))}catch(l){typeof i=="function"&&i({error:l})}typeof s=="function"&&s()}function*zt(a){const{data:e,processingCB:r,successCB:c,failCB:i,alwaysCB:s}=a.payload;typeof r=="function"&&r();try{typeof r=="function"&&r();const l=yield k(O.post,"coupons/v1/gift-cards/",e);l&&l.data&&R&&(yield R(U.setSingleGiftCard({giftCard:l.data.data})),typeof c=="function"&&c(l))}catch(l){typeof i=="function"&&i({error:l})}typeof s=="function"&&s()}function*Kt(a){const{data:e,processingCB:r,successCB:c,failCB:i,alwaysCB:s}=a.payload;try{typeof r=="function"&&r();const{id:l,...u}=e,o=yield k(O.put,"coupons/v1/gift-cards/".concat(l),u);o&&o.data&&R&&(yield R(U.setSingleGiftCard({giftCard:o.data.data})),typeof c=="function"&&c(o))}catch(l){typeof i=="function"&&i({error:l})}typeof s=="function"&&s()}function*Xt(a){const{id:e,processingCB:r,successCB:c,failCB:i,alwaysCB:s}=a.payload;try{typeof r=="function"&&r();const l=yield k(O.delete,"coupons/v1/gift-cards/".concat(e));l&&l.data&&R&&typeof c=="function"&&c(l)}catch(l){typeof i=="function"&&i({error:l})}typeof s=="function"&&s()}function*Qt(a){const{query:e,processingCB:r,successCB:c,failCB:i,alwaysCB:s}=a.payload;try{typeof r=="function"&&r();const l=yield k(O.get,"coupons/v1/gift-cards",{params:e});Array.isArray(l.data)&&R&&(yield R(U.setStoreGiftCards({giftCards:l.data})),typeof c=="function"&&c(l))}catch(l){typeof i=="function"&&i({error:l})}typeof s=="function"&&s()}function*Jt(a){const{id:e,processingCB:r,successCB:c,failCB:i,alwaysCB:s}=a.payload;try{typeof r=="function"&&r();const l=yield k(O.post,"coupons/v1/gift-cards/sendemail",{id:e});l&&l.data&&R&&typeof c=="function"&&c(l)}catch(l){typeof i=="function"&&i({error:l})}typeof s=="function"&&s()}const Zt=[x("READ_GIFT_CARD",Vt),x("CREATE_GIFT_CARD",zt),x("UPDATE_GIFT_CARD",Kt),x("DELETE_GIFT_CARD",Xt),x("REHYDRATE_STORE_GIFT_CARDS",Qt),x("SEND_GIFT_CARD_EMAIL",Jt)],{redux:{sagaEffects:ea}}=acfwpElements,{all:ta}=ea;function*aa(){yield ta([...jt,...Zt])}const{redux:{sagaEffects:Ra,createStore:na,combineReducers:ra,applyMiddleware:sa,createSagaMiddleware:la}}=acfwpElements,ca=a=>sa(...a);function ia(a=void 0){const e=la(),r=na(ra({mainWidgets:Mt,activityWidgets:Lt,giftCards:Ht}),ca([e]));return e.run(aa),r}const{dom:oa,router:{BrowserRouter:ma,Route:da},pathPrefix:fa,appStore:{Provider:pa,store:Ba}}=acfwpElements,ua=ia();document.querySelectorAll("#agcfw_admin_app").forEach(a=>{oa.render(acfwpElements.element.createElement(pa,{store:ua},acfwpElements.element.createElement(ma,null,acfwpElements.element.createElement(da,{path:"".concat(fa,"admin.php"),component:Ft}))),a)});export{Ea as __vite_legacy_guard};
