{function vi_wn_b64DecodeUnicode(e){var t="";if(e)try{t=decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}catch(t){return e}return t}function viSwipeDetect(e,t){var i,o,a,s,n,_,c=e,r=t||function(e){};c.addEventListener("touchstart",(function(e){var t=e.changedTouches[0];i="none",o=t.pageX,a=t.pageY,_=(new Date).getTime()}),{capture:!0}),c.addEventListener("touchmove",(function(e){e.preventDefault()}),!1),c.addEventListener("touchend",(function(e){var t=e.changedTouches[0];s=t.pageX-o,n=t.pageY-a,(new Date).getTime()-_<=300&&(Math.abs(s)>=150&&Math.abs(n)<=100?i=s<0?"left":"right":Math.abs(n)>=150&&Math.abs(s)<=100&&(i=n<0?"up":"down")),r(i)}),!1)}jQuery(document).ready((function(){"use strict";if(jQuery("#message-purchased").length>0){var t=e;_vi_ecommerce_notification_params.detect&&0!=_vi_ecommerce_notification_params.detect||t.detect_address(),viSwipeDetect(document.getElementById("message-purchased"),(function(t){"none"!==t&&(parseInt(e.time_close)>0&&(jQuery("#message-purchased").unbind(),e.setCookie("woo_notification_close",1,3600*parseInt(e.time_close))),e.message_hide(!1,t))}))}})),jQuery(window).on("load",(function(){var t=e;if(t.id=jQuery("#message-purchased").data("product_id"),t.loop=_vi_ecommerce_notification_params.loop,t.loop_session=_vi_ecommerce_notification_params.loop_session,t.loop_session_duration=parseFloat(_vi_ecommerce_notification_params.loop_session_duration),t.loop_session_total=parseInt(_vi_ecommerce_notification_params.loop_session_total),t.init_delay=parseInt(_vi_ecommerce_notification_params.initial_delay),t.total=parseInt(_vi_ecommerce_notification_params.notification_per_page),t.display_time=parseInt(_vi_ecommerce_notification_params.display_time),t.next_time=parseInt(_vi_ecommerce_notification_params.next_time),t.ajax_url=_vi_ecommerce_notification_params.ajax_url,t.products=_vi_ecommerce_notification_params.products,t.messages=_vi_ecommerce_notification_params.messages,t.image=_vi_ecommerce_notification_params.image,t.redirect_target=_vi_ecommerce_notification_params.redirect_target,t.time=_vi_ecommerce_notification_params.time,t.display_effect=_vi_ecommerce_notification_params.display_effect,t.hidden_effect=_vi_ecommerce_notification_params.hidden_effect,t.messages=_vi_ecommerce_notification_params.messages,t.names=_vi_ecommerce_notification_params.names,t.detect=_vi_ecommerce_notification_params.detect,t.billing=_vi_ecommerce_notification_params.billing,t.in_the_same_cate=_vi_ecommerce_notification_params.in_the_same_cate,t.message_custom=_vi_ecommerce_notification_params.message_custom,t.message_number_min=_vi_ecommerce_notification_params.message_number_min,t.message_number_max=_vi_ecommerce_notification_params.message_number_max,t.time_close=_vi_ecommerce_notification_params.time_close,t.show_close=_vi_ecommerce_notification_params.show_close,t.change_virtual_time=_vi_ecommerce_notification_params.change_virtual_time,t.start_virtual_time=_vi_ecommerce_notification_params.start_virtual_time,t.end_virtual_time=_vi_ecommerce_notification_params.end_virtual_time,t.change_message_number=_vi_ecommerce_notification_params.change_message_number,t.current_hour=parseInt(_vi_ecommerce_notification_params.current_hour),t.detect&&0!=t.detect)t.cities=_vi_ecommerce_notification_params.cities,t.country=_vi_ecommerce_notification_params.country,t.init();else{t.cities=[t.getCookie("wn_city")],t.country=[t.getCookie("wn_country")];var i=t.getCookie("wn_ip");i&&"undefined"!=i&&t.init()}}));let e={loop:0,timeOutShow:0,timeOutHide:0,init_delay:5,total:30,display_time:5,next_time:60,count:0,intel:0,wn_popup:0,id:0,messages:"",products:"",ajax_url:"",display_effect:"",hidden_effect:"",time:"",names:"",cities:"",country:"",message_custom:"",message_number_min:"",message_number_max:"",detect:0,show_close:0,first_name_index:[],shortcodes:["{first_name}","{city}","{state}","{country}","{product}","{product_with_link}","{time_ago}","{custom}"],init:function(){if(1==this.loop){let t=Date.now(),i=this.getCookie("woo_notification_displaying");if(i)return this.timeOutShow=setTimeout((function(){e.init()}),i-t),!1}this.ajax_url?this.ajax_get_data():setTimeout((function(){e.get_product()}),1e3*this.init_delay),jQuery("#message-purchased").on("mouseenter",(function(){window.clearTimeout(e.wn_popup),window.clearTimeout(e.timeOutShow),window.clearTimeout(e.timeOutHide)})).on("mouseleave",(function(){e.message_show(!0)}))},detect_address:function(){this.getCookie("wn_ip")||jQuery.getJSON("https://extreme-ip-lookup.com/json/",(function(t){t.query&&e.setCookie("wn_ip",t.query,86400),t.city&&e.setCookie("wn_city",t.city,86400),t.country&&e.setCookie("wn_country",t.country,86400)}))},ajax_get_data:function(){var t;this.ajax_url&&!this.getCookie("woo_notification_close")&&(t=this.id?"&id="+this.id:"",jQuery.ajax({type:"POST",data:"action=woonotification_get_product"+t,url:this.ajax_url,success:function(t){var i=JSON.parse(t);i&&"undefined"!=i&&i.length>0&&(e.products=i,setTimeout((function(){e.get_product()}),1e3*e.init_delay),e.close_notify())},error:function(e){}}))},message_show:function(t=!1){var i=jQuery("#message-purchased");if(t||(this.count++,this.audio()),1==this.loop){var o=Date.now(),a=this.getCookie("woo_notification_displaying");if(!t&&a)return window.clearTimeout(this.timeOutShow),this.timeOutShow=setTimeout((function(){e.get_product()}),a-o),!1;window.clearTimeout(this.timeOutHide),this.timeOutHide=setTimeout((function(){e.message_hide()}),1e3*this.display_time),this.setCookieNew("woo_notification_displaying",this.display_time+this.next_time),i.hasClass(this.hidden_effect)&&i.removeClass(this.hidden_effect),i.addClass(this.display_effect).css("display","flex")}else this.wn_popup=setTimeout((function(){e.message_hide()}),1e3*this.display_time),window.clearTimeout(this.intel),i.hasClass(this.hidden_effect)&&i.removeClass(this.hidden_effect),i.addClass(this.display_effect).css("display","flex")},message_hide:function(t=!1,i=""){var o=jQuery("#message-purchased");switch(o.hasClass(this.display_effect)&&o.removeClass(this.display_effect),i){case"left":o.addClass("bounceOutLeft");break;case"right":o.addClass("bounceOutRight");break;case"up":o.addClass("bounceOutUp");break;case"down":o.addClass("bounceOutDown");break;default:o.addClass(this.hidden_effect)}if(o.fadeOut(1e3),t||this.getCookie("woo_notification_close"))return!1;var a=this.count;1==this.loop?this.total>a&&(window.clearTimeout(this.wn_popup),this.intel=setTimeout((function(){e.get_product()}),1e3*this.next_time)):(window.clearTimeout(this.wn_popup),window.clearTimeout(this.intel))},get_product:function(){let t,i,o,a,s,n,_=this.products,c=this.messages;if("undefined"==_||!_||!c)return!1;if(_.length>0&&c.length>0){n=e.random(0,c.length-1);var r=c[n];n=e.random(0,_.length-1);var m=_[n];this.names&&"undefined"!=this.names?(n=e.random(0,this.names.length-1),t=vi_wn_b64DecodeUnicode(this.names[n])):t="",this.cities&&"undefined"!=this.cities?Array.isArray(this.cities)?(n=e.random(0,this.cities.length-1),a=vi_wn_b64DecodeUnicode(this.cities[n])):a=this.cities:a="",i="",o=this.country,s=this.get_time_string();let p='<span class="wn-popup-product-title">'+m.title+"</span>",h='<a class="wn-popup-product-title-with-link"';h+=' href="'+m.url+'">'+m.title+"</a>";let l="<small>"+_vi_ecommerce_notification_params.str_about+" "+s+" "+_vi_ecommerce_notification_params.str_ago+" </small>",f=this.message_custom,g="",v="";m.thumb?(jQuery("#message-purchased").addClass("wn-product-with-image").removeClass("wn-product-without-image"),g=' <img class="wn-notification-image" src="'+m.thumb+'">'):jQuery("#message-purchased").addClass("wn-product-without-image").removeClass("wn-product-with-image"),v=/{number}/g,f=f.replaceAll(v,this.get_data_custom_number(m.url));let w=this.shortcodes,y=[t,a,"",o,p,h,l,f],b=r;for(let e=w.length-1;e>=0;e--)v=new RegExp(w[e],"g"),b=b.replaceAll(v,y[e]);var u="",d=`<div class="wn-notification-wrapper">${g}<p class="wn-notification-message-container">${b}</p></div>${u}`;jQuery("#message-purchased").html(d),parseInt(this.show_close)>0&&(u='<div id="notify-close"></div>'),jQuery("#message-purchased").html(d+u),e.message_show(),e.close_notify()}},get_data_custom_number:function(t){if(!this.change_message_number)return this.random(this.message_number_min,this.message_number_max);if(this.current_hour<7)return this.message_number_min;let i,o,a,s=e.getCookie("wn_data_custom_number");return s=s?JSON.parse(s):{},s[t]?(o=s[t]-3>this.message_number_min?s[t]-3:this.message_number_min,a=s[t]+2<this.message_number_max?s[t]+2:this.message_number_max):(o=this.message_number_min,a=this.message_number_max),i=this.random(o,a),s[t]=i,s=JSON.stringify(s),e.setCookie("wn_data_custom_number",s,120),i},get_time_cal:function(){return this.change_virtual_time&&this.start_virtual_time&&this.end_virtual_time?this.random(3600*this.start_virtual_time,3600*this.end_virtual_time):this.random(0,3600*this.time)},get_time_string:function(){var e=this.get_time_cal(),t=parseFloat(e/86400);return t>1?1==(t=parseInt(t))?t+" "+_vi_ecommerce_notification_params.str_day:t+" "+_vi_ecommerce_notification_params.str_days:(t=parseFloat(e/3600))>1?1==(t=parseInt(t))?t+" "+_vi_ecommerce_notification_params.str_hour:t+" "+_vi_ecommerce_notification_params.str_hours:(t=parseFloat(e/60))>1?1==(t=parseInt(t))?t+" "+_vi_ecommerce_notification_params.str_min:t+" "+_vi_ecommerce_notification_params.str_mins:t<10?_vi_ecommerce_notification_params.str_few_sec:(t=parseInt(t))+" "+_vi_ecommerce_notification_params.str_secs},close_notify:function(){jQuery("#notify-close").unbind().on("click",(function(){e.message_hide()}))},audio:function(){if(jQuery("#ecommerce-notification-audio").length>0){var e=document.getElementById("ecommerce-notification-audio"),t=function(){e.play().then((function(){setTimeout((function(){e.stop()}),0)})),document.removeEventListener("touchstart",t,!1)};document.addEventListener("touchstart",t,{capture:!0}),e.play()}},random:function(e,t){e=parseInt(e),t=parseInt(t);var i=Math.random()*(t-e);return Math.round(i)+e},setCookie:function(e,t,i){var o=new Date;o.setTime(o.getTime()+1e3*i);var a="expires="+o.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"},setCookieNew:function(e,t,i="",o=!1){var a=new Date,s=a.getTime()+1e3*t;o&&(s=t),a.setTime(s),i||(i=s),document.cookie=e+"="+i+";expires="+a.toUTCString()+";path=/"},getCookie:function(e){for(var t=e+"=",i=decodeURIComponent(document.cookie).split(";"),o=0;o<i.length;o++){for(var a=i[o];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}}}