!function(){"use strict";var e={n:function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,{a:n}),n},d:function(r,n){for(var t in n)e.o(n,t)&&!e.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:n[t]})},o:function(e,r){return Object.prototype.hasOwnProperty.call(e,r)}};!function(){function r(e,r,n,t,o,a,u){try{var i=e[a](u),c=i.value}catch(e){return void n(e)}i.done?r(c):Promise.resolve(c).then(t,o)}function n(e){return function(){var n=this,t=arguments;return new Promise((function(o,a){var u=e.apply(n,t);function i(e){r(u,o,a,i,c,"next",e)}function c(e){r(u,o,a,i,c,"throw",e)}i(void 0)}))}}var t=window.regeneratorRuntime,o=e.n(t);document.addEventListener("DOMContentLoaded",(function(){if("undefined"!=typeof checkoutList){var e=jQuery("form.checkout"),r=[],t=function(e){var r,n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];clearTimeout(r),r=setTimeout((function(){e.apply(n,a)}),t)}}((function(){var e,t,a=jQuery("#"+PayoneerData.listUrlContainerId).val(),i="0"===PayoneerData.isPayForOrder?"form.checkout":"#order_review",c={listUrl:a,fullPageLoading:!1,payButton:PayoneerData.payButtonId,widgetCssUrl:PayoneerData.widgetCssUrl,cssUrl:PayoneerData.cssUrl,onBeforeCharge:(t=n(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Promise((function(e){var r,n,t=jQuery("input[name="+PayoneerData.hostedModeOverrideFlag+"]");t.prop("disabled",!0),PayoneerData.isPayForOrder?(r=function(){return e(!0)},n=function(){return e(!1)},jQuery.ajax({type:"POST",url:wc_checkout_params.ajax_url,xhrFields:{withCredentials:!0},dataType:"json",data:{action:"payoneer_order_pay",fields:jQuery("#order_review").serialize(),params:new URL(document.location).searchParams.toString()},success:function(e){r()},error:function(e,r,t){n(),window.location.reload()}})):(s(e,null,(function(){t.prop("disabled",!1)})),jQuery(i).submit())})),e.next=3,r;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),onBeforeServerError:(e=n(o().mark((function e(r){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e){if(u()){var n=new URL(document.location);n.searchParams.set(PayoneerData.payOrderErrorFlag,!0),window.location.href=n.toString(),e(!1)}jQuery("input[name="+PayoneerData.onErrorRefreshFragmentFlag+"]").prop("value",!0),console.log("onBeforeServerError",r),jQuery("#"+PayoneerData.paymentFieldsContainerId).empty(),jQuery(document.body).trigger("update_checkout"),e(!1)})),e.next=3,n;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(_x){return e.apply(this,arguments)})};a&&""!==a&&(destroyWidget(),console.log("Initializing Payoneer payment widget",c),r.empty().checkoutList(c))}));jQuery(document.body).on("payment_method_selected",(function(){u()&&c()&&a()&&!i()&&t(),d()})),jQuery(document.body).on("updated_checkout",(function(){a()&&!i()&&c()&&t(),d()})),jQuery("#payoneer_place_order").on("click",(function(e){e.preventDefault()})),jQuery("#payoneer_place_order").on("click",(function(e){e.preventDefault()})),d()}function a(){return(r=jQuery("#"+PayoneerData.paymentFieldsContainerId)).length>0}function u(){return"1"===PayoneerData.isPayForOrder}function i(){var e=jQuery("#"+PayoneerData.paymentFieldsContainerId+" .op-payment-widget-container");return!!e.length&&0===jQuery(".GLOBAL_ERROR",e).length}function c(){return"payment_method_payoneer-checkout"===jQuery('.woocommerce-checkout input[name="payment_method"]:checked').attr("id")}function d(){c()?(jQuery("#place_order").prop("disabled",!0).hide().addClass("payoneer-wc-checkout-hidden"),jQuery("#payoneer_place_order").prop("disabled",!1).show()):(jQuery("#payoneer_place_order").prop("disabled",!0).hide(),jQuery("#place_order").prop("disabled",!1).show().removeClass("payoneer-wc-checkout-hidden"))}function s(r,n,t){var o=!1;e.one("checkout_place_order_success",(function(e,t){if(!o)return o=!0,r(!0),n&&n(),!1})),jQuery(document.body).one("checkout_error",(function(e,n){o||(o=!0,t&&t(),r(!1))})),window.setTimeout((function(){o||(o=!0,t&&t(),r(!1))}),2e4)}}),!1)}()}();