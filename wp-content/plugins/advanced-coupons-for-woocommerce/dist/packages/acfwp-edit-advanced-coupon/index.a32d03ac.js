function bi(){import.meta.url,import("_").catch(()=>1);async function*t(){}}function D(t,e=""){e||(e="show");let o=e==="show"?"block":"none";jQuery(t).css("display",o)}function g(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039"};return t.replace(/[&<>"']/g,o=>e[o])}function Vt(){const{decimal_separator:t}=acfw_edit_coupon,e=jQuery(this);let o=e.val()+"";o=="0"+t&&e.val("0"),!(o=="0"||o.substring(0,2)=="0"+t)&&(o=o.replace(/^0+/,""),o=o.substring(0,1)==t?"0"+o:o,e.val(o))}function kt(t,e,o="value",i="label"){return t.map(n=>'<option value="'.concat(n[o],'" ').concat(n[o]==e?"selected":"",">").concat(n[i],"</option>")).toString().replace(/>,</g,"><")}function p(t,e){return t==e?"selected":""}function Gt(t="",e=!1){const{currency_symbol:o,discount_field_options:i}=acfw_edit_coupon,{nodiscount:n,override:c,percent:a,fixed:s}=i,l='<option value="nodiscount" '.concat(p(t,"nodiscount"),">= : ").concat(n,"</option>");return"\n    ".concat(e?l:"",'\n    <option value="override" ').concat(p(t,"override"),">").concat(o," : ").concat(c,'</option>\n    <option value="percent" ').concat(p(t,"percent"),">% : ").concat(a,'</option>\n    <option value="fixed" ').concat(p(t,"fixed"),">-").concat(o," : ").concat(s,"</option>\n  ")}function rt(t=""){const{exactly:e,anyexcept:o,morethan:i,lessthan:n}=acfw_edit_coupon.condition_field_options;return'\n    <option value="=" '.concat(p(t,"="),">").concat(e,'</option>\n    <option value="!=" ').concat(p(t,"!="),">").concat(o,'</option>\n    <option value=">" ').concat(p(t,">"),">").concat(i,'</option>\n    <option value="<" ').concat(p(t,"<"),">").concat(n,"</option>\n  ")}function Yt(t=""){const{exists:e,notexist:o}=acfw_edit_coupon.condition_exists_field_option;return'\n    <option value="exists" '.concat(p(t,"exists"),">").concat(e,'</option>\n    <option value="notexist" ').concat(p(t,"notexist"),">").concat(o,"</option>\n  ")}function U(t){const{decimal_separator:e}=acfw_edit_coupon,o=parseFloat(t.replace(e,"."));return isNaN(o)?0:o}const Ft=jQuery,{cart_weight:Z}=acfw_edit_coupon.cart_condition_fields;function te(){Z.default_data_value={},Z.template_callback=ee,Z.scraper_callback=oe}function ee(t){const{condition:e,value:o}=t,{title:i,desc:n,field:c}=Z,{condition_label:a}=acfw_edit_coupon;return'\n    <div class="cart-weight-field condition-field" data-type="cart-weight">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(i,"</h3>\n        <label>").concat(n,'</label>\n        <div class="field-control">\n            <label>').concat(a,'</label>\n            <select class="condition-select">\n                ').concat(rt(e),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(c,'</label>\n            <input class="condition-value wc_input_decimal" type="text" value="').concat(o>=0?o:"",'">\n        </div>\n    </div>\n    ')}function oe(t){return{condition:Ft(t).find(".condition-select").val(),value:Ft(t).find(".condition-value").val()}}function Lt(t){const{product_id:e,product_label:o,condition_label:i,quantity:n}=t;return'\n    <tr>\n        <td class="product" data-product="'.concat(g(JSON.stringify(t)),'" data-product_id="').concat(e,'">\n            ').concat(o,'\n        </td>\n        <td class="condition">').concat(i,'</td>\n        <td class="quantity">').concat(n,'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    ')}function Rt(t=4){const{no_products_added:e}=acfw_edit_coupon;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat(e,"</td>\n    </tr>\n    ")}const ie=jQuery,{product_quantity:G}=acfw_edit_coupon.cart_condition_fields;function ne(){G.default_data_value={},G.template_callback=ce,G.scraper_callback=ae}function ce(t){const{add_product_label:e}=acfw_edit_coupon,{title:o,product_col:i,condition_col:n,quantity_col:c}=G;let a="";const s=[];if(t.length)for(let l of t)s.push(l.product_id),a+=Lt(l);else a=Rt(4);return'\n    <div class="product-quantity-condition-field condition-set"  data-type="product-quantity">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(o,'</h3>\n        <table class="product-quantity-condition-table acfw-styled-table" data-exclude="').concat(JSON.stringify(s),'">\n            <thead>\n                <tr>\n                    <th class="product">').concat(i,'</th>\n                    <th class="condition">').concat(n,'</th>\n                    <th class="quantity">').concat(c,'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                ').concat(a,'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(e,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    ")}function ae(t){const e=t.querySelectorAll(".product-quantity-condition-table tr td.product"),o=[];return e.forEach(i=>o.push(ie(i).data("product"))),o}const se=jQuery,{customer_registration_date:jt}=acfw_edit_coupon.cart_condition_fields;function le(){jt.template_callback=de,jt.scraper_callback=re}function de(t){const{title:e,desc:o,hours:i}=jt;return'\n    <div class="customer-registration-date-field condition-field" data-type="customer-registration-date">\n\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(e,"</h3>\n\n        <label>").concat(o,'</label>   \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="1" value="').concat(t&&t>-1?t:0,'">\n            <label>').concat(i,"</label>\n        </div>\n    </div>\n    ")}function re(t){return parseInt(se(t).find(".condition-value").val())}const ue=jQuery,{customer_last_ordered:qt}=acfw_edit_coupon.cart_condition_fields;function pe(){qt.template_callback=_e,qt.scraper_callback=fe}function _e(t){const{title:e,desc:o,hours:i}=qt;return'\n    <div class="customer-last-ordered-field condition-field" data-type="customer-last-ordered">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(e,"</h3>\n        <label>").concat(o,'</label>    \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="0" value="').concat(t&&t>-1?t:0,'">\n            <label>').concat(i,"</label>\n        </div>\n    </div>\n    ")}function fe(t){return parseInt(ue(t).find(".condition-value").val())}const bt=jQuery,{total_customer_spend:Y}=acfw_edit_coupon.cart_condition_fields;function he(){Y.default_data_value={},Y.template_callback=be,Y.scraper_callback=ve}function be(t){const{condition:e,value:o,offset:i}=t,{condition_label:n}=acfw_edit_coupon,{title:c,desc:a,total_spend:s,days_offset:l}=Y,d=o?U(o):0;return'\n    <div class="total-customer-spend-field condition-field" data-type="total-customer-spend">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(c,"</h3>\n        <label>").concat(a,'</label>\n        <div class="field-control">\n            <label>').concat(n,'</label>\n            <select class="condition-select">\n                ').concat(rt(e),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(s,'</label>\n            <input class="condition-value wc_input_price" type="text" min="0" value="').concat(!isNaN(d)&&d>-1?o:0,'">\n        </div>\n        <div class="field-control">\n            <label>').concat(l,'</label>\n            <input class="condition-offset" type="number" min="0" value="').concat(i&&i>-1?i:0,'">\n        </div>\n    </div>\n    ')}function ve(t){return{condition:bt(t).find(".condition-select").val(),value:bt(t).find(".condition-value").val(),offset:bt(t).find(".condition-offset").val()}}class me{table_placeholder_row_template(e=4){const{no_products_added:o}=acfw_edit_coupon;return' \n            <tr class="no-result">\n                <td colspan="'.concat(e,'">').concat(o,"</td>\n            </tr>\n        ")}table_markup(){const{add_product_label:e}=acfw_edit_coupon,{tableproduct:o}=acfw_psaeic,{products:i}=o,{label:n}=i;return'\n            <table class="product-stock-availability-exists-in-cart-table acfw-styled-table">\n                <thead>\n                    <tr>\n                        <th class="product">'.concat(n.columns.product,'</th>\n                        <th class="condition">').concat(n.columns.condition,'</th>\n                        <th class="actions"></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ').concat((()=>{let c="";if(i&&i.data&&i.data.length)for(let a of i.data)o.row.data=a,c+=o.row.template_view_row();else c=o.template.table_placeholder_row_template(4);return c})(),'\n                </tbody>\n                <tfoot>\n                    <tr>\n                        <td colspan="4">\n                            <a class="psaeic-btn-add-category-row" href="javascript:void(0);" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_add_category(event)">\n                                <i class="dashicons dashicons-plus"></i>\n                                ').concat(e,"\n                            </a>\n                        </td>\n                    </tr>\n                </tfoot>\n            </table>\n        ")}}const L=jQuery;class $e{trigger_btn_add_category(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=L(i),o.row.data=o.row.data_initial(),o.row.add()}trigger_btn_action_add(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=L(i),o.row.view()}trigger_btn_action_edit(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=L(i),o.row.edit()}trigger_btn_action_cancel(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=L(i),o.row.cancel()}trigger_btn_action_remove(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=L(i),o.row.detect(),o.row.remove()}}const z=jQuery;class ye{constructor(){this._element={$button:z(null),$table:z(this),$tbody:z(this),$row:z(this),$product:z(this),$condition:z(this),colspan:4,data:[]},this._data=this.data_initial()}get element(){return this._element}set element(e){this._element=e}get data(){return this._data}data_initial(){return{product:{id:0,label:""},condition:{id:"",label:""}}}set data(e){this._data=e}template_initiate_select2(){this._element.$tbody.find("select.wc-product-search").trigger("change"),z("body").trigger("wc-enhanced-select-init")}template_add_edit_row(){const{tableproduct:e}=acfw_psaeic,{products:o}=e,{edit:i,add:n,cancel:c}=acfw_edit_coupon.product_table_buttons,{type_to_search:a}=acfw_edit_coupon.bogo_form_fields;return'\n            <tr class="add-edit-form adding">\n                <td class="product" data-product="'.concat(typeof this._data=="object"?g(JSON.stringify(this._data)):0,'">\n                    <div class="object-search-wrap">\n                        <select class="psaeic-select-product wc-product-search" data-placeholder="').concat(a,'" data-action="acfwp_add_products_search">\n                            ').concat(typeof this._data=="object"&&this._data.product.id?'<option value="'.concat(this._data.product.id,'" selected>').concat(this._data.product.label,"</option>"):"",'\n                        </select>                        \n                    </div>\n                </td>\n                <td class="condition">                \n                    <select class="condition-select psaeic-select-condition">\n                        ').concat(Object.keys(o.options.conditions).map(s=>{let l=o.options.conditions[s],d=typeof this._data=="object"&&this._data.condition.id==s?"selected":"";return'<option value="'.concat(s,'" ').concat(d,">").concat(l,"</option>")}).join(""),'\n                    </select> \n                </td>\n                <td class="actions">\n                    <button type="button" class="button-primary psaeic-btn-add" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_add(event)">').concat(typeof this._data=="object"&&this._data.product.id?i:n,'</button>\n                    <button type="button" class="button psaeic-btn-cancel" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_cancel(event)">').concat(c,"</button>\n                </td>\n            </tr>\n        ")}template_view_row(){return'\n            <tr>\n                <td class="product product-'.concat(this._data.product.id,' object" data-product="').concat(g(JSON.stringify(this._data)),'">\n                    ').concat(this._data.product.label,'\n                </td>\n                <td class="condition">').concat(this._data.condition.label,'</td>\n                <td class="actions">\n                    <a class="psaeic-btn-edit" href="javascript:void(0)" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_edit(event)"><span class="dashicons dashicons-edit"></span></a>\n                    <a class="psaeic-btn-remove" href="javascript:void(0)" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_remove(event)"><span class="dashicons dashicons-no"></span></a>\n                </td>\n            </tr>\n        ')}detect(){this._element.$button&&(this._element.$row=this._element.$button.closest("tr"),this._element.$table=this._element.$button.closest(".acfw-styled-table"),this._element.$tbody=this._element.$table.find("tbody"),this._element.$product=this._element.$row.find(".psaeic-select-product"),this._element.$condition=this._element.$row.find(".psaeic-select-condition"),this._element.colspan=this._element.$row.find("td").length,this._element.data=this._element.$row.find("td.product").data("product"))}read(){var i,n,c,a,s,l,d;const{$product:e,$condition:o}=this._element;this._data={product:{id:parseInt((n=(i=e==null?void 0:e.val())==null?void 0:i.toString())!=null?n:""),label:(s=(a=(c=z(e))==null?void 0:c.select2("data")[0])==null?void 0:a.text.replace("\n","").replace(/\s+/g," ").trim())!=null?s:""},condition:{id:(d=(l=o==null?void 0:o.val())==null?void 0:l.toString())!=null?d:"",label:o.find("option:selected").text().replace("\n","").replace(/\s+/g," ").trim()}}}validate(e=!0){const{tableproduct:o}=acfw_psaeic,{fill_form_propery_error_msg:i}=acfw_edit_coupon,{$product:n,$condition:c}=this._element,{product:a}=this._data;return!n.val()||!c.val()?(vex.dialog.alert(i),!1):(this._element.$table.find("td.product.object").each(function(){if(z(this).data("product").product.id==a.id)return vex.dialog.alert(o.products.exists),!1}),e)}add(){this.detect(),!(this._data.product.id&&!this.validate())&&(this._element.$tbody.find("tr.no-result").remove(),this._element.$tbody.append(this.template_add_edit_row()),this.template_initiate_select2())}edit(){this.detect(),this._data=this._element.data,this._element.$row.replaceWith(this.template_add_edit_row()),this.template_initiate_select2()}view(e={}){this.template_initiate_select2(),this.detect(),Object.keys(e).length||this.read(),this.validate()&&this._element.$row.replaceWith(this.template_view_row())}cancel(){this.detect(),this.remove()}remove(){const{tableproduct:e}=acfw_psaeic;this._element.$row.remove(),this._element.$tbody.find("tr").length<=0&&this._element.$tbody.html(e.template.table_placeholder_row_template(this._element.colspan))}}class ge{constructor(){this._products={},this._trigger={},this._template={},this._row={}}get products(){return this._products}set products(e){this._products=e}get template(){return this._template}get trigger(){return this._trigger}get row(){return this._row}build(){this._row=new ye,this._template=new me,this._trigger=new $e,this.save()}save(){window.acfw_psaeic={...acfw_edit_coupon.cart_condition_fields.acfw_product_stock_availability_exists_in_cart,tableproduct:this}}}const we=jQuery,{product_stock_availability_exists_in_cart:tt}=acfw_edit_coupon.cart_condition_fields;function xe(){tt.default_data_value={},tt.template_callback=ke,tt.scraper_callback=je}function ke(t={}){const{title:e,products:o}=tt;o.data=t.products;const i=new ge;return i.products=o,i.build(),'\n        <div class="product-stock-availability-exists-in-cart-field condition-set" data-type="product-stock-availability-exists-in-cart">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(e,"</h3>\n            \n            ").concat(i.template.table_markup(),"\n        </div>\n    ")}function je(t){const e=t.querySelectorAll(".product-stock-availability-exists-in-cart-table tr td.product"),o=[];return e.forEach(i=>o.push(we(i).data("product"))),{products:o}}const vt=jQuery,{has_ordered_before:mt}=acfw_edit_coupon.cart_condition_fields;function qe(){mt.default_data_value={},mt.template_callback=Se,mt.scraper_callback=ze}function Se(t={}){const{condition:e,value:o,products:i}=t,{cart_condition_fields:n,add_product_label:c}=acfw_edit_coupon,{product_col:a,condition_col:s,quantity_col:l}=n.product_quantity,{title:d,type:r,within_a_period:_,number_of_orders:j,num_prev_days:q}=n.has_ordered_before,Q=[];let w="";if(i&&i.length)for(let O of i)Q.push(O.product_id),w+=Lt(O);else w=Rt(4);return'\n    <div class="cart-quantity-field condition-field condition-set" data-type="has-ordered-before">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(d,'</h3>\n        <div class="field-control">\n            <label>').concat(r,'</label>\n            <select class="condition-select has-ordered-before-type">\n                <option value="within-a-period" ').concat(p(e,"within-a-period"),">").concat(_,'</option>\n                <option value="number-of-orders" ').concat(p(e,"number-of-orders"),">").concat(j,'</option>\n            </select>\n        </div>\n        <div class="field-control condition-type-value">\n            <label>').concat(q,'</label>\n            <input class="condition-value" type="number" min="0" value="').concat(o,'">\n        </div>\n        <table class="has-ordered-before-products-table acfw-styled-table" data-exclude="').concat(JSON.stringify(Q),'">\n            <thead>\n                <tr>\n                    <th class="product">').concat(a,'</th>\n                    <th class="condition">').concat(s,'</th>\n                    <th class="quantity">').concat(l,'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                ').concat(w,'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(c,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    ")}function ze(t){const e=t.querySelectorAll(".has-ordered-before-products-table tr td.product"),o=[];return e.forEach(i=>o.push(vt(i).data("product"))),{condition:vt(t).find(".condition-select").val(),value:parseInt(vt(t).find(".condition-value").val()),products:o}}const T=jQuery,{has_ordered_product_categories_before:$t}=acfw_edit_coupon.cart_condition_fields;function Qe(){$t.default_data_value={},$t.template_callback=Ce,$t.scraper_callback=Te,Oe()}function Oe(){const t=document.querySelector("#acfw_cart_conditions");T(t).on("change","select.hopcb-select-type-condition",function(){const{within_a_period_label:e,number_of_orders_label:o}=acfw_edit_coupon,i=T(this),n=i.closest(".has-ordered-product-categories-before-field"),c=n.find(".hopcb-condition-type-value label");i.val()==="within-a-period"?c.text(e):c.text(o)})}function Ce(t={}){const{condition:e,quantity:o}=t,{condition_label:i,cart_condition_fields:{cart_quantity:{field:n},has_ordered_product_categories_before:{title:c,type:a,within_a_period:s,number_of_orders:l,num_prev_days:d,categories:r},product_category:{placeholder:_}},condition_field_options:{exactly:j,anyexcept:q,morethan:Q,lessthan:w}}=acfw_edit_coupon;let O=t.type&&t.type.label?t.type.label:s,_t=[{value:"within-a-period",label:s},{value:"number-of-orders",label:l}],ft=[{value:"=",label:j},{value:"!=",label:q},{value:">",label:Q},{value:"<",label:w}];return'\n        <div class="has-ordered-product-categories-before-field condition-field condition-set" data-type="has-ordered-product-categories-before">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(c,'</h3>\n            \n            <div class="field-control">\n                <label>').concat(a,'</label>\n                <select class="hopcb-select-type-condition">                    \n                    ').concat(_t.map(v=>{let m=t.type?t.type.condition:"within-a-period";const{value:$,label:V}=v;return'<option value="'.concat($,'" ').concat(p(m,$),">").concat(V,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control hopcb-condition-type-value">\n                <label>').concat(O,'</label>\n                <input class="hopcb-select-type-value" type="number" min="0" value="').concat(t.type&&t.type.value?t.type.value:0,'">\n            </div>\n            <div class="field-control categories">\n                <label></label>\n                <select class="hopcb-select-categories wc-enhanced-select" multiple data-placeholder="').concat(_,'">\n                    ').concat(Object.keys(r.options).map(v=>{let m=r.options[v];const $=t.categories&&t.categories.indexOf(parseInt(v))>=0?"selected":"";return'<option value="'.concat(v,'" ').concat($,">").concat(m,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(i,'</label>\n                <select class="hopcb-select-condition">\n                    ').concat(ft.map(v=>{const{value:m,label:$}=v;let ht=(t.condition?t.condition:">")===m?"selected":"";return'<option value="'.concat(m,'" ').concat(ht,">").concat($,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(n,'</label>\n                <input type="number" class="hopcb-select-quantity" value="').concat(o,'" min="').concat(e=="<"?1:0,'">\n            </div>\n            \n        </div>\n    ')}function Bt(t){if(t==null||typeof t=="string"&&t.trim()===""||Array.isArray(t)&&t.length===0)return!1;if(typeof t=="object"){for(const e in t)if(!Bt(t[e]))return!1}return!0}function Te(t){t.querySelectorAll(".has-ordered-product-categories-before-table tr td.category");let e={categories:T(t).find(".hopcb-select-categories").val(),condition:T(t).find(".hopcb-select-condition").val(),quantity:T(t).find(".hopcb-select-quantity").val(),type:{condition:T(t).find(".hopcb-select-type-condition").val(),label:T(t).find(".hopcb-select-type-condition option:selected").text(),value:T(t).find(".hopcb-select-type-value").val()}};return Bt(e)?e:!1}const F=jQuery,{total_customer_spend_on_product_category:yt}=acfw_edit_coupon.cart_condition_fields;function Fe(){yt.default_data_value={},yt.template_callback=Ne,yt.scraper_callback=De,Ie()}function Ie(){const t=document.querySelector("#acfw_cart_conditions");F(t).on("change","select.tcspc-select-type-condition",function(){const{within_a_period_label:e,number_of_orders_label:o}=acfw_edit_coupon,i=F(this),n=i.closest(".total-customer-spend-on-product-category-field"),c=n.find(".tcspc-condition-type-value label");i.val()==="within-a-period"?c.text(e):c.text(o)})}function Ne(t={}){const{condition:e,spend:o}=t,{condition_label:i,cart_condition_fields:{total_customer_spend:{total_spend:n},total_customer_spend_on_product_category:{title:c,type:a,within_a_period:s,number_of_orders:l,num_prev_days:d,categories:r},product_category:{placeholder:_}},condition_field_options:{exactly:j,anyexcept:q,morethan:Q,lessthan:w}}=acfw_edit_coupon;let O=t.type&&t.type.label?t.type.label:s,_t=[{value:"within-a-period",label:s},{value:"number-of-orders",label:l}],ft=[{value:"=",label:j},{value:"!=",label:q},{value:">",label:Q},{value:"<",label:w}];return'\n        <div class="total-customer-spend-on-product-category-field condition-field condition-set" data-type="total-customer-spend-on-product-category">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(c,'</h3>\n            \n            <div class="field-control">\n                <label>').concat(a,'</label>\n                <select class="tcspc-select-type-condition">                    \n                    ').concat(_t.map(v=>{let m=t.type?t.type.condition:"within-a-period";const{value:$,label:V}=v;return'<option value="'.concat($,'" ').concat(p(m,$),">").concat(V,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control tcspc-condition-type-value">\n                <label>').concat(O,'</label>\n                <input class="tcspc-select-type-value" type="number" min="0" value="').concat(t.type&&t.type.value?t.type.value:0,'">\n            </div>\n            <div class="field-control categories">\n                <label></label>\n                <select class="tcspc-select-categories wc-enhanced-select" multiple data-placeholder="').concat(_,'">\n                    ').concat(Object.keys(r.options).map(v=>{let m=r.options[v];const $=t.categories&&t.categories.indexOf(parseInt(v))>=0?"selected":"";return'<option value="'.concat(v,'" ').concat($,">").concat(m,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(i,'</label>\n                <select class="tcspc-select-condition">\n                    ').concat(ft.map(v=>{const{value:m,label:$}=v;let ht=(t.condition?t.condition:">")===m?"selected":"";return'<option value="'.concat(m,'" ').concat(ht,">").concat($,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(n,'</label>\n                <input type="text" class="tcspc-select-spend wc_input_decimal" value="').concat(o!=null?o:0,'">\n            </div>\n            \n        </div>\n    ')}function Ht(t){if(t==null||typeof t=="string"&&t.trim()===""||Array.isArray(t)&&t.length===0)return!1;if(typeof t=="object"){for(const e in t)if(!Ht(t[e]))return!1}return!0}function De(t){let e={categories:F(t).find(".tcspc-select-categories").val(),condition:F(t).find(".tcspc-select-condition").val(),spend:F(t).find(".tcspc-select-spend").val(),type:{condition:F(t).find(".tcspc-select-type-condition").val(),label:F(t).find(".tcspc-select-type-condition option:selected").text(),value:F(t).find(".tcspc-select-type-value").val()}};return Ht(e)?e:!1}const It=jQuery,{shipping_zone_region:et}=acfw_edit_coupon.cart_condition_fields;function Ae(){et.default_data_value={},et.template_callback=Je,et.scraper_callback=Me}function Je(t){const{value:e}=t,{title:o,zone_label:i,zone_placeholder:n,regions_label:c,regions_placeholder:a,zone_options:s}=et,l=e&&e.length?e:[];return'\n    <div class="shipping-zone-region-field condition-field" data-type="shipping-zone-region"\n        data-zones="'.concat(g(JSON.stringify(s)),'"\n        data-regions="').concat(g(JSON.stringify(l)),'">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">').concat(o,'</h3>\n        <div class="field-control">\n            <label>').concat(i,'</label>\n            <select class="condition-select wc-enhanced-select" data-placeholder="').concat(g(n),'">\n                <option value="">').concat(n,"</option>\n                ").concat(Pe(t,s),'\n            </select>\n        </div>\n        <div class="field-control regions">\n            <label>').concat(c,'</label>\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(g(a),'">\n            </select>\n        </div>\n    </div>\n    ')}function Me(t){return{condition:It(t).find(".condition-select").val(),value:It(t).find(".condition-value").val()}}function Pe(t,e){const{condition:o}=t;let i="";for(let n in e){const c=e[n];i+='\n            <option value="'.concat(n,'" ').concat(p(o,n),">\n                ").concat(c.name,"\n            </option>\n        ")}return i}const K=jQuery,{custom_taxonomy:R}=acfw_edit_coupon.cart_condition_fields,{cart_condition_fields:Ee,condition_field_options:We}=acfw_edit_coupon;function Ve(){R.default_data_value={},R.template_callback=Le,R.scraper_callback=Re}function Le(t){const{condition:e,value:o,qtyCondition:i,quantity:n}=t,{title:c,select_taxonomy:a,product_type:s,select_terms:l}=R,{field:d}=Ee.cart_quantity,{condition_label:r}=acfw_edit_coupon,{exactly:_,anyexcept:j,morethan:q,lessthan:Q}=We,w=i||">",O=o&&o.length?o:[];return'\n    <div class="custom-taxonomy-field condition-field" data-type="custom-taxonomy" \n      data-selected_terms="'.concat(g(JSON.stringify(O)),'">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">').concat(c,'</h3>\n      <div class="field-control">\n        <select class="condition-select wc-enhanced-select custom-taxonomy" data-placeholder="').concat(a,'">\n          <option value="">').concat(a,"</option>\n          ").concat(Be(e),'\n        </select>\n      </div>\n      <div class="field-control field-control-wide">\n        <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(l,'">\n        </select>\n      </div>\n      <div class="field-control condition">\n            <label>').concat(r,'</label>\n            <select class="condition-select qty-condition-select">\n                <option value="=" ').concat(w=="="?"selected":"",">").concat(_,'</option>\n                <option value="!=" ').concat(w=="!="?"selected":"",">").concat(j,'</option>\n                <option value=">" ').concat(w==">"?"selected":"",">").concat(q,'</option>\n                <option value="<" ').concat(w=="<"?"selected":"",">").concat(Q,'</option>\n            </select>\n        </div>\n        <div class="field-control quantity">\n            <label>').concat(d,'</label>\n            <input type="number" class="condition-quantity" value="').concat(typeof n=="number"?n:0,'" min="').concat(i=="<"?1:0,'">\n        </div>\n    </div>\n    ')}function Re(t){return{condition:K(t).find(".condition-select").val(),value:K(t).find(".condition-value").val(),qtyCondition:K(t).find(".qty-condition-select").val(),quantity:K(t).find(".condition-quantity").val()}}function Be(t){const{tax_options:e,product_type:o}=R;let i="";for(let n of e){const{name:c,label:a}=n;i+='\n      <option value="'.concat(c,'" ').concat(p(t,c),">\n        ").concat(a,"\n      </option>\n    ")}return i}const X=jQuery,{cart_condition_fields:Qt}=acfw_edit_coupon,{custom_user_meta:gt,custom_cart_item_meta:wt}=Qt;function He(){gt.default_data_value={},gt.template_callback=Nt,gt.scraper_callback=Dt,wt.default_data_value={},wt.template_callback=Nt,wt.scraper_callback=Dt}function Nt(t,e){const{condition:o,key:i,value:n,type:c}=t,{condition_label:a}=acfw_edit_coupon,{title:s,meta_key:l,meta_value:d,value_type:r}=Qt[e],_=e.replace(/_/g,"-");return'\n    <div class="'.concat(_,'-field condition-field" data-type="').concat(_,'">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">').concat(s,'</h3>\n      <div class="field-control wider">\n        <label>').concat(r,'</label>\n        <select class="value-type">\n          ').concat(Ue(c,e),'\n        </select>\n      </div>\n      <div class="field-control">\n        <label>').concat(a,'</label>\n        <select class="condition-select">\n          ').concat(rt(o),"\n          ").concat(e==="custom_cart_item_meta"?Yt(o):"",'\n        </select>\n      </div>\n      <div class="field-control wider">\n        <label>').concat(l,'</label>\n        <input class="condition-key" type="text" value="').concat(i||"",'">\n      </div>\n      <div class="field-control wider">\n        <label>').concat(d,'</label>\n        <input class="condition-value" type="text" value="').concat(n||n>-1?n:"",'">\n      </div>\n    </div>\n  ')}function Dt(t){return{condition:X(t).find(".condition-select").val(),key:X(t).find(".condition-key").val(),value:X(t).find(".condition-value").val(),type:X(t).find(".value-type").val()}}function Ue(t,e){const{type_options:o}=Qt[e];let i="";for(let n in o){const c=o[n];i+='<option value="'.concat(n,'" ').concat(p(t,n),">").concat(c,"</option>")}return i}const xt=jQuery,{number_of_orders:ot}=acfw_edit_coupon.cart_condition_fields;function Ke(){ot.default_data_value={},ot.template_callback=Xe,ot.scraper_callback=Ze}function Xe(t){const{condition:e,value:o,offset:i}=t,{condition_label:n}=acfw_edit_coupon,{title:c,desc:a,count_label:s,prev_days_label:l}=ot;return'\n    <div class="number-of-orders-field cart-quantity-field condition-field" data-type="number-of-orders">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">'.concat(c,"</h3>\n      <label>").concat(a,'</label>\n      <div class="field-control">\n        <label>').concat(n,'</label>\n        <select class="condition-select">\n            ').concat(rt(e),'\n        </select>\n      </div>\n      <div class="field-control">\n          <label>').concat(s,'</label>\n          <input class="condition-value" type="number" min="0" value="').concat(o>=0?o:"",'">\n      </div>\n      <div class="field-control">\n          <label>').concat(l,'</label>\n          <input class="condition-offset" type="number" min="0" value="').concat(i>=0?i:"",'">\n      </div>\n    </div>\n  ')}function Ze(t){return{condition:xt(t).find(".condition-select").val(),value:xt(t).find(".condition-value").val(),offset:xt(t).find(".condition-offset").val()}}const E=jQuery,{coupons_applied_in_cart:B}=acfw_edit_coupon.cart_condition_fields;function Ge(){B.default_data_value={condition:"",value:[]},B.template_callback=Ye,B.scraper_callback=to,E("#acfw_cart_conditions").on("change",".coupons-applied-in-cart-field .condition-select",io)}function Ye(t){const{condition:e,value:o,quantity:i,options:n}=t,{condition_label:c}=acfw_edit_coupon,a=E("#post_ID").val(),s=JSON.stringify(o),{title:l,desc:d,coupons_label:r,quantity_label:_,select_coupons:j}=B;return'\n    <div class="coupons-applied-in-cart-field condition-field" data-type="coupons-applied-in-cart">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">'.concat(l,'</h3>\n      <p class="condition-field-desc">').concat(d,'</p>\n      <div class="field-control coupons">\n        <label>').concat(r,'</label>\n        <select multiple class="wc-product-search condition-value" \n          data-placeholder="').concat(j,'" \n          value="').concat(s,'" \n          data-action="acfw_search_coupons" \n          data-exclude="[').concat(a,']"\n          data-include="true"\n        >').concat(oo(n),'</select>\n      </div>\n      <div class="field-control">\n        <label>').concat(c,'</label>\n        <select class="condition-select">\n          ').concat(eo(e),'\n        </select>\n      </div>\n      <div class="field-control">\n        <label>').concat(_,'</label>\n        <input type="number" value="').concat(i!=null?i:1,'" min="1" class="condition-quantity">\n      </div>\n    </div>\n  ')}function to(t){return{condition:E(t).find(".condition-select").val(),value:E(t).find(".condition-value").val(),quantity:E(t).find(".condition-quantity").val()}}function eo(t){const{condition_options:e}=B;let o="";for(let i in e){const n=e[i];o+='<option value="'.concat(i,'" ').concat(p(t,i),">").concat(n,"</option>")}return o}function oo(t){let e="";for(let o in t){const i=t[o];e+='<option value="'.concat(o,'" selected>').concat(i,"</option>")}return e}function io(){const t=E(this),o=t.closest(".coupons-applied-in-cart-field").find(".condition-quantity"),i=o.closest(".field-control");console.log("field",t.val()),t.val()==="atleast"?(o.prop("disabled",!1),i.show()):(o.prop("disabled",!0),i.hide())}const it=jQuery;function no(){const t=document.querySelector("#acfw_cart_conditions");ne(),te(),le(),pe(),he(),xe(),qe(),Qe(),Fe(),Ae(),Ve(),He(),Ke(),Ge(),it(t).on("change","input.condition-value",co),it(t).on("change",".custom-cart-item-meta-field .condition-select",ao)}function co(){const t=it(this);if(t.closest(".condition-field").find("select.value-type").val()==="number"){const i=parseInt(t.val()+"");t.val(isNaN(i)?"":Math.round(i))}}function ao(){var i;const t=it(this),o=t.closest(".condition-field").find(".condition-value");["exists","notexist"].includes(t.val().toString())?(o.val(0),o.prop("disabled",!0),o.parent().hide()):["exists","notexist"].includes((i=t.data("prevValue"))==null?void 0:i.toString())&&(o.val(""),o.prop("disabled",!1),o.parent().show()),t.data("prevValue",t.val().toString())}const At=jQuery,Jt=document.querySelector("#acfw_add_products");function W(t){At(Jt).data("editing",t),At(Jt).find("#save-add-products").prop("disabled",!t)}function Ut(t=[],e=!1){const{discount_type:o,discount_value:i}=e,{edit:n,add:c,cancel:a}=acfw_edit_coupon.product_table_buttons,{type_to_search:s}=acfw_edit_coupon.bogo_form_fields,l=typeof e=="object"?so(e):"",d=typeof e=="object"?n:c,r=i&&U(i)>=0&&o!=="nodiscount"?i:"";return'\n    <tr class="add-edit-form adding">\n        <td class="product" data-object="'.concat(typeof e=="object"?g(JSON.stringify(e)):0,'">\n            <div class="object-search-wrap">\n                <select class="product-in-cart wc-product-search"\n                    data-placeholder="').concat(s,'"\n                    data-action="acfwp_add_products_search"\n                    data-exclude="').concat(g(JSON.stringify(t)),'">').concat(l,'</select>\n            </div>\n        </td>\n        <td class="quantity">\n            <input type="number" class="condition-quantity" value="').concat(typeof e=="object"?e.quantity:1,'" min="1">\n        </td>\n        <td class="price">\n            <div>\n            <select class="discount_type">\n                ').concat(Gt(o,!0),'\n            </select>\n            <input type="text" class="discount_value short wc_input_price" value="').concat(r,'">\n            </div>\n        </td>\n        <td class="actions">\n            <button type="button" class="condition-product-add button-primary">').concat(d,'</button>\n            <button type="button" class="cancel button">').concat(a,"</button>\n        </td>\n    </tr>\n    ")}function so(t){const{product_id:e,product_label:o}=t;return'<option value="'.concat(e,'">').concat(o,"</option>")}function Ot(t){const{product_id:e,product_label:o,quantity:i,discount_type:n,discount_value:c}=t,a=n!=="nodiscount"?c:"";return'\n    <tr>\n        <td class="product product-'.concat(e,' object" data-product="').concat(g(JSON.stringify(t)),'">\n            ').concat(o,'\n        </td>\n        <td class="quantity">').concat(i,'</td>\n        <td class="price">(').concat(n,") ").concat(a,'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    ')}function ut(t=4){const{no_products_added:e}=acfw_edit_coupon;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat(e,"</td>\n    </tr>\n    ")}const St=jQuery;function lo(){const t=St(this),e=t.closest(".acfw-styled-table"),o=e.find("tbody"),i=e.data("exclude");o.find("tr.no-result").remove(),o.append(Ut(i)),o.find("select.discount_type").trigger("change"),o.find("select.wc-product-search").trigger("change"),St("body").trigger("wc-enhanced-select-init")}function ro(){const t=jQuery(this),e=t.closest("tr"),o=t.closest(".acfw-styled-table"),i=o.find("tbody"),n=e.find(".product").data("product"),{product_id:c}=n;let a=o.data("exclude");a=typeof a=="object"?a:[],a.splice(a.indexOf(c),1),i.find("tr.no-result").remove(),e.replaceWith(Ut(a,n)),i.find("select.discount_type").trigger("change"),i.find("select.wc-product-search").trigger("acfw_product_select"),o.data("exclude",a),o.find("select.wc-product-search").data("exclude",a),St("body").trigger("wc-enhanced-select-init")}function uo(){const{fill_form_propery_error_msg:t,product_exists_in_table:e}=acfw_edit_coupon,o=jQuery(this),i=o.closest("tr"),n=o.closest("table.acfw-styled-table"),c=i.find(".wc-product-search"),a=i.find(".condition-quantity"),s=i.find("select.discount_type").val().toString(),l=i.find("input.discount_value").val().toString();let d=n.data("exclude");const r=parseInt(i.find(".wc-product-search").val().toString()),_={product_id:r,quantity:parseInt(i.find(".condition-quantity").val().toString()),product_label:i.find(".wc-product-search option:selected").text(),discount_type:s,discount_value:l};if(!c.val()||!a.val()||a.val()<1||s!=="nodiscount"&&(isNaN(U(l))||U(l)<0)){vex.dialog.alert(t);return}if(d.includes(r)){vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);return}d=typeof d=="object"?d:[],d.push(r),i.replaceWith(Ot(_)),n.data("exclude",d),n.find(".wc-product-search").data("exclude",d),W(!0)}function po(){const t=jQuery(this),e=t.closest("tr"),o=t.closest("table"),i=e.closest("tbody"),n=e.find("td").length,c=e.find("td.product").data("object");let a=o.data("exclude");if(a.includes(c.product_id)){vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);return}typeof c=="object"?(a=typeof a=="object"?a:[],a.push(c.product_id),e.replaceWith(Ot(c)),o.data("exclude",a),o.find(".wc-product-search").data("exclude",a)):(e.remove(),i.find("tr").length<=0&&i.html(ut(n)))}function _o(){const t=jQuery(this),e=t.closest("tr"),o=e.closest("table"),i=e.closest("tbody"),n=e.find("td").length,c=e.find("td.object").data("product"),a=o.data("exclude"),s=a.indexOf(parseInt(c.product_id));s!==-1&&a.splice(s,1),o.data("exclude",a),o.find(".wc-product-search").data("exclude",a),e.remove(),i.find("tr").length<=0&&i.html(ut(n)),W(!0)}const u=jQuery,{post_id:nt}=woocommerce_admin_meta_boxes,k=document.querySelector("#acfw_add_products"),ct=k?k.querySelector(".acfw-overlay"):null;function fo(){u("#acfw_bogo_deals").find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click");const{post_status:t}=acfw_edit_coupon,e=k.querySelectorAll("table.acfw-styled-table tbody td.object"),o=k.querySelector(".add-before-cart-condition-check-field input[type='checkbox']");let i=[],n;e.forEach(c=>{n=u(c).data("product"),n&&i.push(n)}),D(ct,"show"),u.post(ajaxurl,{action:"acfw_save_add_products_data",coupon_id:nt,products:i.length?i:"empty",add_before_conditions:u(o).is(":checked")?1:0,nonce:u("#acfw_add_products").data("nonce")},c=>{c.status=="success"?t!=="publish"&&(u("input[name='post_title']").val()||u("input[name='post_title']").val("coupon-"+nt),u("select[name='post_status']").append(new Option("Published","publish")).val("publish"),u("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),u("input#publish").click()):c.error_msg&&(vex.dialog.alert(c.error_msg),console.log(c),u(k).addClass("save-error")),u(k).find("button#clear-add-products").prop("disabled",!1),W(!1),D(ct,"hide")},"json")}function ho(){const t=u(this);if(!confirm(t.data("prompt")))return;const e=k.querySelector("table.acfw-styled-table tbody");D(ct,"show"),u.post(ajaxurl,{action:"acfw_clear_add_products_data",coupon_id:nt,_wpnonce:t.data("nonce")},o=>{o.status=="success"?(u(e).html(ut(4)),t.prop("disabled",!0),W(!1),u("#post-status-display").text()!="Published"&&(u("input[name='post_title']").val()||u("input[name='post_title']").val("coupon-"+nt),u("input#publish").click())):(o.error_msg&&vex.dialog.alert(o.error_msg),console.log(o)),D(ct,"hide")},"json")}function bo(t){u(".coupon_data_tabs").find(".acfw_add_products_tab").hasClass("active")&&u(k).data("editing")&&(t.preventDefault(),u(k).find("#save-add-products").trigger("click"),setTimeout(()=>{u(k).hasClass("save-error")?u(k).removeClass("save-error"):u("form#post").submit()},1e3))}const N=jQuery,f=document.querySelector("#acfw_add_products");function vo(t=jQuery){t(f).on("click",".acfw-styled-table tfoot .add-table-row",lo),t(f).on("click",".acfw-styled-table td.actions a.edit",ro),t(f).on("click","tr.add-edit-form .actions .condition-product-add",uo),t(f).on("click","tr.add-edit-form .actions .cancel",po),t(f).on("click",".acfw-styled-table td.actions a.remove",_o),t(f).on("click","button#save-add-products",fo),t(f).on("click","button#clear-add-products",ho),t(f).on("change","select.discount_type",$o),t(f).on("blur",".wc_input_price",Vt),t("form#post").on("submit",bo),t(f).css("min-height",t("#coupon_options ul.coupon_data_tabs").height()+10),t(f).on("click",".acfw-styled-table .actions .remove",()=>W(!0)),t(f).on("change","input[name='add_before_cart_condition']",()=>W(!0)),mo(),t(document).ajaxComplete(yo),t(f).on("change","select.discount_type",go)}function mo(){const t=N(f).data("products"),e=N(f).find(".add-products-data-table tbody");if(t.length>0){let o="";t.forEach(i=>{o+=Ot(i)}),e.html(o)}else e.html(ut(4))}function $o(){const t=N(this);t.closest("tr").find(".discount_value").prop("disabled",t.val()==="nodiscount")}function yo(t,e){const o=e.getResponseHeader("X-Subscription-IDs");if(!o)return;let i=N(f).data("subscription_ids")||[];const n=o.split(",").map(c=>parseInt(c));N(f).data("subscription_ids",[...i,...n].filter((c,a,s)=>s.indexOf(c)===a))}function go(){const t=N(f).data("subscription_ids")||[];if(!t.length)return;const e=N(this),i=e.closest("tr").find("select.wc-product-search"),n=parseInt(i.val());!t.includes(n)||e.val()==="nodiscount"||(vex.dialog.alert(N(f).data("subscription_discount_error")),e.val("nodiscount"),e.trigger("change"))}var I=jQuery;function wo(){I("body").on("change","#customer_email,#acfw_auto_apply_coupon_field,#usage_limit,#usage_limit_per_user,#_acfw_enable_virtual_coupons",xo),I("#customer_email,#acfw_auto_apply_coupon_field").trigger("change")}function xo(){const t=I("#customer_email"),e=parseInt(I("#usage_limit").val()),o=parseInt(I("#usage_limit_per_user").val()),i=I("#acfw_auto_apply_coupon_field"),n=I("#_acfw_enable_virtual_coupons").is(":checked"),c=I("#acfw-auto-apply-coupon .auto-apply-warning");(t.val()||e||o||n)&&i.prop("checked")?c.show():c.hide()}var ko=jQuery;function jo(){const t=ko(this),e=t.closest("tr"),o=e.find(".select-shipping-method"),i=e.closest(".acfw-styled-table");i.data("exclude");const n=i.data("zonemethods")||[],c=n.filter(s=>s.zone_id==t.val()),a=c.length?c[0].methods:[];o.empty(),a.length&&(a.map(s=>o.append(new Option(s.label,s.value))),o.trigger("change"))}function qo(t){const e=t.find(".select-shipping-zone"),o=e.find("option:first");t.removeClass("fresh"),e.val(o.prop("value")),e.trigger("change")}const Mt=jQuery,Pt=document.querySelector("#acfw_shipping_overrides");function pt(t){Mt(Pt).data("editing",t),Mt(Pt).find("#save-shipping-overrides").prop("disabled",!t)}function Ct(t){const{no_shipping_overrides_added:e}=acfw_edit_coupon;return'\n        <tr class="no-result">\n            <td colspan="'.concat(t,'">').concat(e,"</td>\n        </tr>\n    ")}const h=jQuery,A=document.querySelector("#acfw_shipping_overrides"),{post_id:zt}=woocommerce_admin_meta_boxes;function So(){const{post_status:t}=acfw_edit_coupon,e=A.querySelector(".acfw-overlay"),o=h(this),i=A.querySelectorAll(".shipping-overrides-table tbody tr td.object"),n=[];i.forEach(c=>{n.push(h(c).data("object"))}),D(e,"show"),o.prop("disabled",!0),h.post(ajaxurl,{action:"acfw_save_shipping_overrides",coupon_id:zt,overrides:n.length?n:"empty",nonce:h("#acfw_shipping_overrides").data("nonce")},c=>{c.status=="success"?t!=="publish"&&(h("input[name='post_title']").val()||h("input[name='post_title']").val("coupon-"+zt),h("select[name='post_status']").append(new Option("Published","publish")).val("publish"),h("#publishing-action").append('\n            <input type="hidden" name="publish" value="Publish">\n          '),h("input#publish").click()):(c.error_msg&&vex.dialog.alert(c.error_msg),console.log(c)),h(A).find("#clear-shipping-overrides").prop("disabled",!1),pt(!1),D(e,"hide")},"json")}function zo(){const t=h(this);if(!confirm(t.data("prompt")))return;const e=h(A.querySelector("table.acfw-styled-table")),o=e.find("tbody"),i=A.querySelector(".acfw-overlay");D(i,"show"),h.post(ajaxurl,{action:"acfw_clear_shipping_overrides",coupon_id:woocommerce_admin_meta_boxes.post_id,_wpnonce:t.data("nonce")},n=>{if(n.status=="success"){let c=e.find("thead tr th").length;o.html(""),o.find("tr").length<=0&&o.append(Ct(c)),e.data("exclude",[]),t.prop("disabled",!0),pt(!1),jQuery("#post-status-display").text()!="Published"&&(jQuery("input[name='post_title']").val()||jQuery("input[name='post_title']").val("coupon-"+zt),jQuery("input#publish").click())}else n.error_msg&&vex.dialog.alert(n.error_msg),console.log(n);D(i,"hide")},"json")}function Kt(t){h(A).data("editing")&&(t.preventDefault(),h(A).find("#save-shipping-overrides").trigger("click"),h("form#post").off("submit",Kt),setTimeout(()=>{h("form#post").submit()},1e3))}const Qo=jQuery,Oo=document.querySelector("#acfw_shipping_overrides");function Xt(t={}){const{add:e,edit:o,cancel:i}=acfw_edit_coupon.product_table_buttons,{shipping_zone:n,discount_type:c,discount_value:a}=t,l=Qo(Oo).find(".shipping-overrides-table").data("zonemethods")||[],d=l.map(q=>({value:q.zone_id,label:q.zone_name})),r=a&&U(a)>=0?a:"",_=n>=0||n==="nozone"?o:e;return'\n    <tr class="add-edit-form fresh">\n      <td class="shipping-zone" data-object="'.concat(g(JSON.stringify(t)),'">\n        <div>\n          <select class="select-shipping-zone wc-enhanced-select" data-placeholder="Select shipping zone">\n            ').concat(kt(d,n),'\n          </select>\n        </div>\n      </td>\n      <td class="shipping-method">\n        <div>\n          <select class="select-shipping-method wc-enhanced-select" data-placeholder="Select shipping method">\n            ').concat(Co(l,t),'\n          </select>\n        </div>\n      </td>\n      <td class="discount">\n        <select class="discount-type">\n          ').concat(To(c),'\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="').concat(r,'">\n      </td>\n      <td class="actions">\n        <button type="button" class="add button-primary">').concat(_,'</button>\n        <button type="button" class="cancel button">').concat(i,"</button>\n      </td>\n    </tr>\n  ")}function Co(t,e){const{shipping_zone:o,shipping_method:i}=e;if(o==="nozone"&&i||o>=0&&i){const n=t.filter(a=>a.zone_id==o),c=n.length?n[0].methods:[];return kt(c,i)}else{const n=t.length?t[0].methods:[];return kt(n,i)}}function To(t=""){const{currency_symbol:e,discount_field_options:o}=acfw_edit_coupon,{override:i,percent:n,fixed:c}=o;return'\n    <option value="percent" '.concat(p(t,"percent"),">% : ").concat(n,'</option>\n    <option value="fixed" ').concat(p(t,"fixed"),">-").concat(e," : ").concat(c,'</option>\n    <option value="override" ').concat(p(t,"override"),">").concat(e," : ").concat(i,"</option>\n  ")}const Fo=jQuery,Io=document.querySelector("#acfw_shipping_overrides");function Tt(t){const{shipping_zone:e,discount_type:o,discount_value:i,shipping_method:n}=t,s=(Fo(Io).find(".shipping-overrides-table").data("zonemethods")||[]).filter(_=>_.zone_id==e);if(!s.length)return"";const{zone_name:l,methods:d}=s[0],r=d.filter(_=>_.value==n);return r.length?'\n    <tr>\n      <td class="shipping-zone object" data-object="'.concat(g(JSON.stringify(t)),'">\n        ').concat(l,'\n      </td>\n      <td class="shipping-method">\n        ').concat(r[0].label,'\n      </td>\n      <td class="discount">\n        (').concat(o,") ").concat(i,'\n      </td>\n      <td class="actions">\n        <a class="edit" href="javascript:void(0);">\n          <span class="dashicons dashicons-edit"></span>\n        </a>\n        <a class="remove" href="javascript:void(0);">\n          <span class="dashicons dashicons-no"></span>\n        </a>\n      </td>\n    </tr>\n  '):""}const at=jQuery;function No(){const t=at(this),e=t.closest(".acfw-styled-table"),o=e.find("tbody");e.data("exclude"),o.find("tr.no-result").remove(),o.append(Xt()),at("body").trigger("wc-enhanced-select-init");const i=e.find("tr.add-edit-form.fresh");qo(i)}function Do(){const{fill_form_propery_error_msg:t,shipping_zone_already_added:e}=acfw_edit_coupon,o=at(this),i=o.closest("tr"),n=i.closest(".acfw-styled-table");let c=parseInt(i.find(".select-shipping-zone").val()+""),a=i.find(".select-shipping-method").val()+"";c=c>=0&&!isNaN(c)?c:"nozone";let s=n.data("exclude");if((c<0||!a)&&!(c==="nozone"&&a)){vex.dialog.alert(t);return}if(s.filter(d=>d.zone==c&&d.method==a).length){vex.dialog.alert(e);return}const l={shipping_zone:c,shipping_method:a,discount_type:i.find(".discount-type").val(),discount_value:i.find(".discount_value").val()};i.replaceWith(Tt(l)),s.push({zone:c,method:a}),n.data("exclude",s),pt(!0)}function Ao(){const t=jQuery(this),e=t.closest("tr"),o=t.closest(".acfw-styled-table"),i=o.find("tbody"),n=e.find(".shipping-zone").data("object");let c=o.data("exclude")||[];c=c.filter(a=>a.zone!=n.shipping_zone||a.method!=n.shipping_method),i.find("tr.no-result").remove(),e.replaceWith(Xt(n)),o.data("exclude",c),at("body").trigger("wc-enhanced-select-init")}function Jo(){const t=jQuery(this),e=t.closest("tr"),o=t.closest("table"),i=e.closest("tbody"),n=e.find("td").length,c=e.find("td.shipping-zone").data("object");let a=o.data("exclude");a=a.filter(s=>s.zone!=c.shipping_zone||s.method!=c.shipping_method),o.data("exclude",a),e.remove(),i.find("tr").length<=0&&i.append(Ct(n)),pt(!0)}function Mo(){const{shipping_zone_already_added:t}=acfw_edit_coupon,e=jQuery(this),o=e.closest("tr"),i=e.closest("table"),n=o.closest("tbody"),c=o.find("td").length,a=o.find("td.shipping-zone").data("object"),{shipping_zone:s,shipping_method:l}=a;let d=i.data("exclude");if(d.filter(r=>r.zone==s&&r.method==l).length){vex.dialog.alert(t);return}s==="nozone"&&l||s>=0&&l?(d.push({zone:s,method:s}),o.replaceWith(Tt(a)),i.data("exclude",d)):(o.remove(),n.find("tr").length<=0&&n.append(Ct(c)))}const y=jQuery,x=document.querySelector("#acfw_shipping_overrides");function Po(){y(x).on("click",".acfw-styled-table tfoot .add-table-row",No),y(x).on("change","tr.add-edit-form .select-shipping-zone",jo),y(x).on("click","tr.add-edit-form .actions .add",Do),y(x).on("click","tr .actions .edit",Ao),y(x).on("click","tr .actions .remove",Jo),y(x).on("click","tr.add-edit-form .actions .cancel",Mo),y(x).on("blur",".wc_input_price",Vt),y(x).on("click","#save-shipping-overrides",So),y(x).on("click","#clear-shipping-overrides",zo),y("form#post").on("submit",Kt),y(x).css("min-height",y("#coupon_options ul.coupon_data_tabs").height()+10),Eo()}function Eo(){const t=y(x).find(".shipping-overrides-table"),e=t.find("tbody"),o=t.data("overrides");o.length&&(e.find("tr.no-result").remove(),o.forEach(i=>{e.append(Tt(i))}))}const b=jQuery;function Wo(){const t=document.querySelector("#acfw_scheduler");b(t).on("change acfw_load",'.days-time-fields input[type="checkbox"]',Ro),b(t).on("change acfw_load",".days-time-fields input.time-field",Bo),b(t).on("change",".days-time-fields input.time-field",Ho),b(t).on("change acfw_load",".acfw-scheduler-section .date-field",Uo),b(t).find('.days-time-fields input[type="checkbox"], .days-time-fields input.time-field').trigger("acfw_load"),b(t).find(".acfw-scheduler-section .date-field").trigger("acfw_load"),b(".wrap").on("submit","form#post",Lo),Vo()}function Vo(){b(".days-time-fields input.time-field").flatpickr({allowInput:!0,enableTime:!0,noCalendar:!0,altInput:!0,altFormat:"h:i K",dateFormat:"H:i",onOpen:function(t,e,o){if(e===""){var i=new Date;i.setHours(0),i.setMinutes(0),o.setDate(i),b(".days-time-fields input.time-field").trigger("change")}}})}function Lo(t){b(".days-time-fields input.time-field").hasClass("error")&&(t.preventDefault(),vex.dialog.alert({unsafeMessage:acfw_edit_coupon.invalid_scheduler_time}),b("#publishing-action .spinner").removeClass("is-active"),b("#publishing-action #publish").removeClass("disabled"))}function Ro(){const t=b(this),e=t.closest(".days-time-field");e.find(".start-time").prop("disabled",!t.is(":checked")||t.is(":disabled")),e.find(".end-time").prop("disabled",!t.is(":checked")||t.is(":disabled"))}function Bo(){const t=b(this).closest(".days-time-field"),e=t.find(".start-time"),o=t.find(".end-time"),i=st(o.val())+1,n=st(e.val())-1,c=i?Et(i):"",a=n?Et(n):"";e.attr("max",c!=null?c:""),o.attr("min",a!=null?a:"")}function Ho(){const t=b(this).closest(".days-time-field"),e=t.find(".start-time"),o=t.find(".end-time"),i=st(e.val()),n=st(o.val());i>=n?e.addClass("error"):e.removeClass("error"),n<=i?o.addClass("error"):o.removeClass("error")}function Uo(){const t=b(this).closest(".options_group"),e=t.find("#_acfw_schedule_start"),o=t.find("#_acfw_schedule_expire"),i=Ko(e.is(":disabled")?"":e.val(),e.is(":disabled")?"":o.val());Zt().forEach(n=>{const c=b(".".concat(n,"-time-field"));i.includes(n)?c.find('input[type="checkbox"]').prop("disabled",!1).trigger("change"):(c.find('input[type="checkbox"]').prop("disabled",!0),c.find(".time-field").prop("disabled",!0))})}function st(t){const[e,o]=t.split(":").map(i=>parseInt(i));return e*60+o}function Et(t){const e=Math.floor(t/60),o=t-e*60;return"".concat(String(e).padStart(2,"0"),":").concat(String(o).padStart(2,"0"))}function Ko(t,e){const o=Zt(),i=[];if(!t||!e)return o;for(const n=new Date(t);n<=new Date(e);n.setDate(n.getDate()+1))i.push(o[n.getDay()]);return[...new Set(i)]}function Zt(){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]}const S=jQuery,{bogo_toggle_editing_mode:Xo}=acfw_edit_coupon,{post_id:Zo}=woocommerce_admin_meta_boxes;function Go(){const t=document.querySelector("#acfw_bogo_deals");S(t).on("change acfw_load","select#bogo-deals-type",Yo),S(t).on("change acfw_load","select#bogo-condition-type,select#bogo-deals-type",ei),S(t).on("change acfw_load",".bogo-auto-add-products-field input[type='checkbox']",()=>Xo(!0)),S(t).on("save_bogo_deals",ti),S(t).find("select#bogo-deals-type").trigger("acfw_load")}function Yo(){const t=S(this),o=t.closest("#acfw_bogo_deals").find(".bogo-auto-add-products-field"),i=o.find("input[type='checkbox']");t.val()==="specific-products"?(i.prop("disabled",!1),o.addClass("show")):(i.prop("disabled",!1),o.removeClass("show"))}function ti(){const t=S(this),e=t.find("select#bogo-deals-type"),o=t.find(".bogo-auto-add-products-field input[type='checkbox']");e.val()==="specific-products"&&S.post(ajaxurl,{action:"acfw_save_bogo_additional_settings",coupon_id:Zo,auto_add_products:o.is(":checked")?"yes":"no",nonce:S(".bogo-settings-field").data("nonce")})}function ei(){const t=S("#acfw_bogo_deals"),e=t.find("input[name='bogo_type'][value='once']"),o=t.find("input[name='bogo_type'][value='repeat']"),i=t.find("#bogo-condition-type").val(),n=t.find("#bogo-deals-type").val();t.find(".repeat-incompatible").remove(),n==="any-products"&&i!=="any-products"?(e.prop("checked",!0),o.prop("disabled",!0),o.closest(".radio-group-wrap").append('<span class="repeat-incompatible">'.concat(acfw_edit_coupon.repeat_incompatible_notice,"</span>"))):o.prop("disabled",!1)}const H=document.querySelector(".acfw-sort-coupon-priority-field"),J=jQuery;function oi(){J(H).on("change","select#_acfw_coupon_sort_select",ii),J(H).on("change","input#_acfw_coupon_sort_priority",ni),J(H).find("select#_acfw_coupon_sort_select").trigger("change")}function ii(){const t=J(this),e=J(H).find("input#_acfw_coupon_sort_priority"),o=t.val().toString();switch(o){case"0":case"1":case"10":case"30":case"50":case"90":e.hide(),e.val(o);break;case"custom":default:e.show(),e.val(J(H).data("value"))}}function ni(){const t=J(this),e=parseInt(t.val());(isNaN(e)||1>e)&&(vex.dialog.alert(acfw_edit_coupon.coupon_sort_invalid),t.val(""))}const lt=jQuery;function ci(){lt("body").on("change load_virtual_coupon","#_acfw_enable_virtual_coupons",ai),lt("#_acfw_enable_virtual_coupons").trigger("load_virtual_coupon")}function ai(t){const e=jQuery(this),o=e.closest(".inside"),i=lt("select.acfw-allowed-customers");t.type==="change"&&o.find(".save-notice").show(),e.is(":checked")?(o.removeClass("disabled"),i.prop("disabled",!0),i.closest(".options_group").hide(),Wt(!0)):(o.addClass("disabled"),i.closest(".options_group").show(),i.prop("disabled",!1),Wt(!1))}function Wt(t){var i;const e=jQuery(".form-field._acfw_coupon_url_field"),o=jQuery(".form-field._acfw_code_url_override_field");if(t){const n=(i=lt("#acfw-virtual-coupon .feature-control").data("labels"))!=null?i:{};e.find("input,button,span").hide(),e.append('<span class="vc-manage-url-coupon">'.concat(n.url_coupon_message,"</span>")),o.hide()}else e.find(".vc-manage-url-coupon").remove(),e.find("input,button,span").show(),o.show()}const dt=jQuery;function si(){li(),dt("body").on("change acfw_load","input#individual_use",di),dt("input#individual_use").trigger("acfw_load")}function li(){const t=jQuery("p.acfw-coupons-restriction-field"),e=t.closest(".options_group");t.insertAfter("p.form-field.individual_use_field"),e.remove()}function di(){const t=dt(this),e=dt(".acfw_allowed_coupons_field"),o=e.find("select");t.is(":checked")?(o.prop("disabled",!1),e.show()):(o.prop("disabled",!0),e.hide())}const P=jQuery;function ri(){P("#woocommerce-coupon-data").on("change acfwp_load","#discount_type",ui),P("#woocommerce-coupon-data").on("change acfw_load","select#discount_type",pi),P("#discount_type").trigger("acfwp_load"),P("#_acfw_coupon_label").trigger("acfw_load")}function ui(){const t=P(this),e=t.closest(".woocommerce_options_panel").find("._acfw_percentage_discount_cap_field");t.val()==="percent"||t.val()==="acfw_percentage_cashback"?(e.addClass("show"),e.find("input").prop("disabled",!1)):(e.removeClass("show"),e.find("input").prop("disabled",!0))}function pi(){P("#_acfw_coupon_label").prop("disabled",!1)}const M=jQuery;function _i(){M("#general_coupon_data").on("change acfw_load","#discount_type",fi),M("#general_coupon_data").on("change acfw_load","#discount_type",hi),M("#discount_type").trigger("acfw_load")}function fi(){const t=M(this),e=M("p.coupon_amount_field label"),{cashback_coupon:o}=acfw_edit_coupon;let i=e.data("default_label");switch(i||(e.data("default_label",e.text()),i=e.text()),t.val()){case"acfw_percentage_cashback":e.text(o.cashback_percentage_label);break;case"acfw_fixed_cashback":e.text(o.cashback_amount_label);break;default:e.text(i);break}}function hi(){const t=M(this),e=M("#_acfw_cashback_waiting_period");switch(t.val()){case"acfw_percentage_cashback":case"acfw_fixed_cashback":e.closest("p.form-field").show(),e.prop("disabled",!1);break;default:e.closest("p.form-field").hide(),e.prop("disabled",!0);break}}const{modules:C}=acfw_edit_coupon;jQuery(document).ready(t=>{C.indexOf("acfw_cart_conditions_module")>-1&&no(),C.indexOf("acfw_add_free_products_module")>-1&&vo(),C.indexOf("acfw_auto_apply_module")>-1&&wo(),C.indexOf("acfw_shipping_overrides_module")>-1&&Po(),C.indexOf("acfw_scheduler_module")>-1&&Wo(),C.indexOf("acfw_bogo_deals_module")>-1&&Go(),C.indexOf("acfw_sort_coupons_module")>-1&&oi(),C.indexOf("acfw_virtual_coupons_module")>-1&&ci(),si(),ri(),_i()});export{bi as __vite_legacy_guard};
